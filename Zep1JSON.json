{"paragraphs":[{"text":"%md\n## Exploration des donnees GDELT via Spark\nDans ce notebook nous allons commencer a explorer les donnees GDELT qu'on a stockées sur S3","user":"anonymous","dateUpdated":"2021-01-22T11:48:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Exploration des donnees GDELT via Spark</h2>\n<p>Dans ce notebook nous allons commencer a explorer les donnees GDELT qu&rsquo;on a stockées sur S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989337_-1207234127","id":"20210119-001455_427787611","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27258","dateFinished":"2021-01-22T11:48:59+0000","dateStarted":"2021-01-22T11:48:59+0000"},{"text":"%md\n## Conf Spark et AWS, classes SCALA","user":"anonymous","dateUpdated":"2021-01-22T12:47:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Conf Spark et AWS, classes SCALA</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989338_-517167708","id":"20210120-153142_1755659799","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27259","dateFinished":"2021-01-22T12:47:37+0000","dateStarted":"2021-01-22T12:47:37+0000"},{"text":"// %spark.dep : Commande magic de déclaration de dépendance dans une cellue et non l'interp., avant zeppelin(0.9.0)\n\nimport com.mongodb.client.{MongoClient, MongoDatabase}\nimport org.apache.spark.SparkConf\nimport org.apache.spark.sql.SparkSession\nimport com.mongodb.spark.MongoSpark\nimport org.bson.Document\nimport com.mongodb.spark._\nimport com.mongodb.spark.config.ReadConfig\nimport org.bson.codecs.configuration.CodecRegistries.{fromProviders, fromRegistries}\nimport com.mongodb.spark.config._\n\nval sparkConf = new SparkConf().setAll(Map(\n      \"spark.master\" -> \"local\",\n      \"spark.scheduler.mode\" -> \"FIFO\",\n      \"spark.speculation\" -> \"false\",\n      \"spark.reducer.maxSizeInFlight\" -> \"48m\",\n      \"spark.serializer\" -> \"org.apache.spark.serializer.KryoSerializer\",\n      \"spark.kryoserializer.buffer.max\" -> \"1g\",\n      \"spark.shuffle.file.buffer\" -> \"32k\",\n      \"spark.default.parallelism\" -> \"12\",\n      \"spark.sql.shuffle.partitions\" -> \"12\",\n      \"spark.mongodb.input.uri\" -> \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.COLLtest\",\n      \"spark.mongodb.output.uri\" -> \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.COLLtest\"\n    ))","user":"anonymous","dateUpdated":"2021-01-22T12:20:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mongodb.client.{MongoClient, MongoDatabase}\nimport org.apache.spark.SparkConf\nimport org.apache.spark.sql.SparkSession\nimport com.mongodb.spark.MongoSpark\nimport org.bson.Document\nimport com.mongodb.spark._\nimport com.mongodb.spark.config.ReadConfig\nimport org.bson.codecs.configuration.CodecRegistries.{fromProviders, fromRegistries}\nimport com.mongodb.spark.config._\nsparkConf: org.apache.spark.SparkConf = org.apache.spark.SparkConf@547e7cff\n"}]},"apps":[],"jobName":"paragraph_1611309989338_1017521794","id":"20210119-154718_610761631","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T12:20:03+0000","dateFinished":"2021-01-22T12:20:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27261"},{"text":"val spark = SparkSession.builder()\n      .appName(\"MongoSparkConnectorIntro\")\n      .config(sparkConf)\n      .config(\"spark.mongodb.input.uri\",\"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.COLLtest\") // redondant mais pour mémoire conf possible ici\n      .config(\"spark.mongodb.output.uri\",\"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.COLLtest\")\n      .getOrCreate()","user":"anonymous","dateUpdated":"2021-01-22T12:43:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"spark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@1be10cf1\n"}]},"apps":[],"jobName":"paragraph_1611309989338_-1388425479","id":"20210120-025425_1968563308","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:01+0000","dateFinished":"2021-01-22T10:45:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27262"},{"text":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicSessionCredentials\n    \n    \nval AWS_ID = \"ASIAQFYNH7PYXZDPLQN4\"\nval AWS_KEY = \"VH8c1djkzD7f3eobdIULgw8/Lbuf/P3KehjcsI4q\"\nval AWS_SESSION_KEY = \"FwoGZXIvYXdzEPT//////////wEaDMr/wo9zlBbaPMoILSLQAUdm8ApuIxWsqYSs9MRz7QHNu0aTcLGooQOA+MIBQjpa3bhB0cIFZbBN2fXM+FJIAn2zVM4hYIB8NIO3ycEpteGBottEylq8kT6aHfKLzyGVzI9A2+eG8yJPrcwDyk6NNL0TrIn7kdYvgxb5H5sMjkFkkhxpo1R8ilqzBirDE3jnJLaXovxiFuLm8uBOQfJZFTU+yVg5bEsu+18Dq00Ltl/u6gZVJJOxs3KIlo0O9SQPQ0nh71hPyxiVoBx0b5DwDwOrmNWx998G4BrvElGY4n0o1MaqgAYyLfE3mQev4e2KufIjESSRpOjSSxpxbYRhvtz3buGFJba2h2oGWQdCV2C3AvUk8g==\"\n\n// la classe AmazonS3Client n'est pas serializable\n// on rajoute l'annotation @transient pour dire a Spark de ne pas essayer de serialiser cette classe et l'envoyer aux executeurs\n@transient val awsClient = new AmazonS3Client(new BasicSessionCredentials(AWS_ID, AWS_KEY, AWS_SESSION_KEY))\n\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID) // mettre votre ID du fichier credentials.csv\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY) // mettre votre secret du fichier credentials.csv\nsc.hadoopConfiguration.set(\"fs.s3a.session.token\",AWS_SESSION_KEY)\n","user":"anonymous","dateUpdated":"2021-01-22T10:45:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicSessionCredentials\nAWS_ID: String = ASIAQFYNH7PYXZDPLQN4\nAWS_KEY: String = VH8c1djkzD7f3eobdIULgw8/Lbuf/P3KehjcsI4q\nAWS_SESSION_KEY: String = FwoGZXIvYXdzEPT//////////wEaDMr/wo9zlBbaPMoILSLQAUdm8ApuIxWsqYSs9MRz7QHNu0aTcLGooQOA+MIBQjpa3bhB0cIFZbBN2fXM+FJIAn2zVM4hYIB8NIO3ycEpteGBottEylq8kT6aHfKLzyGVzI9A2+eG8yJPrcwDyk6NNL0TrIn7kdYvgxb5H5sMjkFkkhxpo1R8ilqzBirDE3jnJLaXovxiFuLm8uBOQfJZFTU+yVg5bEsu+18Dq00Ltl/u6gZVJJOxs3KIlo0O9SQPQ0nh71hPyxiVoBx0b5DwDwOrmNWx998G4BrvElGY4n0o1MaqgAYyLfE3mQev4e2KufIjESSRpOjSSxpxbYRhvtz3buGFJba2h2oGWQdCV2C3AvUk8g==\nawsClient: com.amazonaws.services.s3.AmazonS3Client = com.amazonaws.services.s3.AmazonS3Client@6d7704f6\n"}]},"apps":[],"jobName":"paragraph_1611309989339_-1911884791","id":"20210119-001533_1709596473","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:08+0000","dateFinished":"2021-01-22T10:45:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27263"},{"text":"%md\nOn utilise des case class et un schéma/format de spark mongo pour la gestion des schémas, ainsi que (plus bas) des encoders.\nA noter que ce code a été délicat à mettre en place, mais est a priori le plus concis. A noter les erreurs de types de datas sur la BigTable de GDELT !","user":"anonymous","dateUpdated":"2021-01-22T12:44:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On utilise des case class et un schéma/format de spark mongo pour la gestion des schémas, ainsi que (plus bas) des encoders.<br/>A noter que ce code a été délicat à mettre en place, mais est a priori le plus concis. A noter les erreurs de types de datas sur la BigTable de GDELT !</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989339_-872653524","id":"20210120-133157_1607520446","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27264","dateFinished":"2021-01-22T12:44:18+0000","dateStarted":"2021-01-22T12:44:18+0000"},{"text":"case class Mention(GLOBALEVENTID: BigInt,\n                    EventTimeDate: BigInt,\n                    MentionTimeDate: BigInt,\n                    MentionType: Int,\n                    MentionSourceName: String,\n                    MentionIdentifier: String, \n                    SentenceID: Int, \n                    Actor1CharOffset: Double, \n                    Actor2CharOffset: Double,\n                    ActionCharOffset: Double,\n                    InRawText: Int,\n                    Confidence: Int,\n                    MentionDocLen: Int,\n                    MentionDocTone: Double,\n                    MentionDocTranslationInfo: String,\n                    Extras: String\n                    )\n                    ","user":"anonymous","dateUpdated":"2021-01-22T10:45:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Mention\n"}]},"apps":[],"jobName":"paragraph_1611309989339_276244869","id":"20210120-120806_1912867166","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:16+0000","dateFinished":"2021-01-22T10:45:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27266"},{"text":"case class Event(GLOBALEVENTID: Int,\n                   SQLDATE: Int,\n                   MonthYear: Int,\n                   Year: Int,\n                   FractionDate: Double,\n                   Actor1Code: String,\n                   Actor1Name: String,\n                   Actor1CountryCode: String,\n                   Actor1KnownGroupCode: String,\n                   Actor1EthnicCode: String,\n                   Actor1Religion1Code: String,\n                   Actor1Religion2Code: String,\n                   Actor1Type1Code: String,\n                   Actor1Type2Code: String,\n                   Actor1Type3Code: String,\n                   Actor2Code: String,\n                   Actor2Name: String,\n                   Actor2CountryCode: String,\n                   Actor2KnownGroupCode: String,\n                   Actor2EthnicCode: String,\n                   Actor2Religion1Code: String,\n                   Actor2Religion2Code: String,\n                   Actor2Type1Code: String,\n                   Actor2Type2Code: String,\n                   Actor2Type3Code: String,\n                   IsRootEvent: Int,\n                   EventCode: String,\n                   EventBaseCode: String,\n                   EventRootCode: String,\n                   QuadClass: Int,\n                   GoldsteinScale: Double,\n                   NumMentions: Int,\n                   NumSources: Int,\n                   NumArticles: Int,\n                   AvgTone: Double,\n                   Actor1Geo_Type: Int,\n                   Actor1Geo_FullName: String,\n                   Actor1Geo_CountryCode: String,\n                   Actor1Geo_ADM1Code: String,\n                   Actor1Geo_ADM2Code: String,\n                   Actor1Geo_Lat: Double,\n                   Actor1Geo_Long: Double,\n                   Actor1Geo_FeatureID: String,\n                   Actor2Geo_Type: Int,\n                   Actor2Geo_FullName: String,\n                   Actor2Geo_CountryCode: String,\n                   Actor2Geo_ADM1Code: String,\n                   Actor2Geo_ADM2Code: String,\n                   Actor2Geo_Lat: Double,\n                   Actor2Geo_Long: Double,\n                   Actor2Geo_FeatureID: String,\n                   ActionGeo_Type: Int,\n                   ActionGeo_FullName: String,\n                   ActionGeo_CountryCode: String,\n                   ActionGeo_ADM1Code: String,\n                   ActionGeo_ADM2Code: String,\n                   ActionGeo_Lat: Double,\n                   ActionGeo_Long: Double,\n                   ActionGeo_FeatureID: String,\n                   DATEADDED: BigInt,\n                   SOURCEURL: String)","user":"anonymous","dateUpdated":"2021-01-22T12:45:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Event\n"}]},"apps":[],"jobName":"paragraph_1611309989339_-553653885","id":"20210120-034336_871831499","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:22+0000","dateFinished":"2021-01-22T10:45:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27267"},{"text":"case class GkG(\n    GKGRECORDID: String,\n    DATE: BigInt,\n    SourceCollectionIdentifier: Int,\n    SourceCommonName: String,\n    DocumentIdentifier: String,\n    Counts: String,\n    V2Counts: String,\n    Themes: String,\n    V2Themes: String,\n    Locations: String,\n    V2Locations: String,\n    Persons: String,\n    V2Persons: String,\n    Organizations: String,\n    V2Organizations: String,\n    V2Tone: String,\n    Dates: String,\n    GCAM: String,\n    SharingImage: String,\n    RelatedImages: String,\n    SocialImageEmbeds: String,\n    SocialVideoEmbeds: String,\n    Quotations: String,\n    AllNames: String,\n    Amounts: String,\n    TranslationInfo: String,\n    Extras: String,\n    Year: Int,\n    Month: Int,\n    Day: Int)","user":"anonymous","dateUpdated":"2021-01-22T12:45:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class GkG\n"}]},"apps":[],"jobName":"paragraph_1611310397769_1263752784","id":"20210122-101317_1784712652","dateCreated":"2021-01-22T10:13:17+0000","dateStarted":"2021-01-22T10:45:26+0000","dateFinished":"2021-01-22T10:45:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27268"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Encoders\n\nval encoderSchemaEvent = Encoders.product[Event].schema \nencoderSchemaEvent.printTreeString()\n\n\n","user":"anonymous","dateUpdated":"2021-01-22T10:45:35+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- GLOBALEVENTID: integer (nullable = false)\n |-- SQLDATE: integer (nullable = false)\n |-- MonthYear: integer (nullable = false)\n |-- Year: integer (nullable = false)\n |-- FractionDate: double (nullable = false)\n |-- Actor1Code: string (nullable = true)\n |-- Actor1Name: string (nullable = true)\n |-- Actor1CountryCode: string (nullable = true)\n |-- Actor1KnownGroupCode: string (nullable = true)\n |-- Actor1EthnicCode: string (nullable = true)\n |-- Actor1Religion1Code: string (nullable = true)\n |-- Actor1Religion2Code: string (nullable = true)\n |-- Actor1Type1Code: string (nullable = true)\n |-- Actor1Type2Code: string (nullable = true)\n |-- Actor1Type3Code: string (nullable = true)\n |-- Actor2Code: string (nullable = true)\n |-- Actor2Name: string (nullable = true)\n |-- Actor2CountryCode: string (nullable = true)\n |-- Actor2KnownGroupCode: string (nullable = true)\n |-- Actor2EthnicCode: string (nullable = true)\n |-- Actor2Religion1Code: string (nullable = true)\n |-- Actor2Religion2Code: string (nullable = true)\n |-- Actor2Type1Code: string (nullable = true)\n |-- Actor2Type2Code: string (nullable = true)\n |-- Actor2Type3Code: string (nullable = true)\n |-- IsRootEvent: integer (nullable = false)\n |-- EventCode: string (nullable = true)\n |-- EventBaseCode: string (nullable = true)\n |-- EventRootCode: string (nullable = true)\n |-- QuadClass: integer (nullable = false)\n |-- GoldsteinScale: double (nullable = false)\n |-- NumMentions: integer (nullable = false)\n |-- NumSources: integer (nullable = false)\n |-- NumArticles: integer (nullable = false)\n |-- AvgTone: double (nullable = false)\n |-- Actor1Geo_Type: integer (nullable = false)\n |-- Actor1Geo_FullName: string (nullable = true)\n |-- Actor1Geo_CountryCode: string (nullable = true)\n |-- Actor1Geo_ADM1Code: string (nullable = true)\n |-- Actor1Geo_ADM2Code: string (nullable = true)\n |-- Actor1Geo_Lat: double (nullable = false)\n |-- Actor1Geo_Long: double (nullable = false)\n |-- Actor1Geo_FeatureID: string (nullable = true)\n |-- Actor2Geo_Type: integer (nullable = false)\n |-- Actor2Geo_FullName: string (nullable = true)\n |-- Actor2Geo_CountryCode: string (nullable = true)\n |-- Actor2Geo_ADM1Code: string (nullable = true)\n |-- Actor2Geo_ADM2Code: string (nullable = true)\n |-- Actor2Geo_Lat: double (nullable = false)\n |-- Actor2Geo_Long: double (nullable = false)\n |-- Actor2Geo_FeatureID: string (nullable = true)\n |-- ActionGeo_Type: integer (nullable = false)\n |-- ActionGeo_FullName: string (nullable = true)\n |-- ActionGeo_CountryCode: string (nullable = true)\n |-- ActionGeo_ADM1Code: string (nullable = true)\n |-- ActionGeo_ADM2Code: string (nullable = true)\n |-- ActionGeo_Lat: double (nullable = false)\n |-- ActionGeo_Long: double (nullable = false)\n |-- ActionGeo_FeatureID: string (nullable = true)\n |-- DATEADDED: decimal(38,0) (nullable = true)\n |-- SOURCEURL: string (nullable = true)\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.Encoders\nencoderSchemaEvent: org.apache.spark.sql.types.StructType = StructType(StructField(GLOBALEVENTID,IntegerType,false), StructField(SQLDATE,IntegerType,false), StructField(MonthYear,IntegerType,false), StructField(Year,IntegerType,false), StructField(FractionDate,DoubleType,false), StructField(Actor1Code,StringType,true), StructField(Actor1Name,StringType,true), StructField(Actor1CountryCode,StringType,true), StructField(Actor1KnownGroupCode,StringType,true), StructField(Actor1EthnicCode,StringType,true), StructField(Actor1Religion1Code,StringType,true), StructField(Actor1Religion2Code,StringType,true), StructField(Actor1Type1Code,StringType,true), StructField(Actor1Type2Code,StringType,true), StructField(Actor1Type3C..."}]},"apps":[],"jobName":"paragraph_1611309989339_-651186537","id":"20210120-033726_49806970","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:35+0000","dateFinished":"2021-01-22T10:45:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27269"},{"text":"val encoderSchemaMention = Encoders.product[Mention].schema \nencoderSchemaMention.printTreeString()\n\n","user":"anonymous","dateUpdated":"2021-01-22T12:45:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- GLOBALEVENTID: decimal(38,0) (nullable = true)\n |-- EventTimeDate: decimal(38,0) (nullable = true)\n |-- MentionTimeDate: decimal(38,0) (nullable = true)\n |-- MentionType: integer (nullable = false)\n |-- MentionSourceName: string (nullable = true)\n |-- MentionIdentifier: string (nullable = true)\n |-- SentenceID: integer (nullable = false)\n |-- Actor1CharOffset: double (nullable = false)\n |-- Actor2CharOffset: double (nullable = false)\n |-- ActionCharOffset: double (nullable = false)\n |-- InRawText: integer (nullable = false)\n |-- Confidence: integer (nullable = false)\n |-- MentionDocLen: integer (nullable = false)\n |-- MentionDocTone: double (nullable = false)\n |-- MentionDocTranslationInfo: string (nullable = true)\n |-- Extras: string (nullable = true)\n\nencoderSchemaMention: org.apache.spark.sql.types.StructType = StructType(StructField(GLOBALEVENTID,DecimalType(38,0),true), StructField(EventTimeDate,DecimalType(38,0),true), StructField(MentionTimeDate,DecimalType(38,0),true), StructField(MentionType,IntegerType,false), StructField(MentionSourceName,StringType,true), StructField(MentionIdentifier,StringType,true), StructField(SentenceID,IntegerType,false), StructField(Actor1CharOffset,DoubleType,false), StructField(Actor2CharOffset,DoubleType,false), StructField(ActionCharOffset,DoubleType,false), StructField(InRawText,IntegerType,false), StructField(Confidence,IntegerType,false), StructField(MentionDocLen,IntegerType,false), StructField(MentionDocTone,DoubleType,false), StructField(MentionDocTranslationInfo,StringType,true), StructFie..."}]},"apps":[],"jobName":"paragraph_1611309989340_-367084908","id":"20210119-002718_48755229","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:39+0000","dateFinished":"2021-01-22T10:45:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27270"},{"text":"val encoderSchemaGkG = Encoders.product[GkG].schema \nencoderSchemaGkG.printTreeString()","user":"anonymous","dateUpdated":"2021-01-22T12:45:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- GKGRECORDID: string (nullable = true)\n |-- DATE: decimal(38,0) (nullable = true)\n |-- SourceCollectionIdentifier: integer (nullable = false)\n |-- SourceCommonName: string (nullable = true)\n |-- DocumentIdentifier: string (nullable = true)\n |-- Counts: string (nullable = true)\n |-- V2Counts: string (nullable = true)\n |-- Themes: string (nullable = true)\n |-- V2Themes: string (nullable = true)\n |-- Locations: string (nullable = true)\n |-- V2Locations: string (nullable = true)\n |-- Persons: string (nullable = true)\n |-- V2Persons: string (nullable = true)\n |-- Organizations: string (nullable = true)\n |-- V2Organizations: string (nullable = true)\n |-- V2Tone: string (nullable = true)\n |-- Dates: string (nullable = true)\n |-- GCAM: string (nullable = true)\n |-- SharingImage: string (nullable = true)\n |-- RelatedImages: string (nullable = true)\n |-- SocialImageEmbeds: string (nullable = true)\n |-- SocialVideoEmbeds: string (nullable = true)\n |-- Quotations: string (nullable = true)\n |-- AllNames: string (nullable = true)\n |-- Amounts: string (nullable = true)\n |-- TranslationInfo: string (nullable = true)\n |-- Extras: string (nullable = true)\n |-- Year: integer (nullable = false)\n |-- Month: integer (nullable = false)\n |-- Day: integer (nullable = false)\n\nencoderSchemaGkG: org.apache.spark.sql.types.StructType = StructType(StructField(GKGRECORDID,StringType,true), StructField(DATE,DecimalType(38,0),true), StructField(SourceCollectionIdentifier,IntegerType,false), StructField(SourceCommonName,StringType,true), StructField(DocumentIdentifier,StringType,true), StructField(Counts,StringType,true), StructField(V2Counts,StringType,true), StructField(Themes,StringType,true), StructField(V2Themes,StringType,true), StructField(Locations,StringType,true), StructField(V2Locations,StringType,true), StructField(Persons,StringType,true), StructField(V2Persons,StringType,true), StructField(Organizations,StringType,true), StructField(V2Organizations,StringType,true), StructField(V2Tone,StringType,true), StructField(Dates,StringType,true), StructField(GC..."}]},"apps":[],"jobName":"paragraph_1611310728178_1585694230","id":"20210122-101848_288279262","dateCreated":"2021-01-22T10:18:48+0000","dateStarted":"2021-01-22T10:45:44+0000","dateFinished":"2021-01-22T10:45:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27271"},{"text":"\n//val encoderSchemaEventTrans = Encoders.product[EventTrans].schema \n//encoderSchemaEventTrans.printTreeString()\n\n//val encoderSchemaMentionTrans = Encoders.product[MentionTrans].schema \n//encoderSchemaMentionTrans.printTreeString()\n","user":"anonymous","dateUpdated":"2021-01-22T10:19:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611309989340_1601726315","id":"20210120-123453_74396172","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27272"},{"text":"%md\nMentions et events traduits inférés avec un objet Structype (variante de la solution case class ci-dessus, juste pour mémoire)","user":"anonymous","dateUpdated":"2021-01-22T12:46:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Mentions et events traduits inférés avec un objet Structype (variante de la solution case class ci-dessus, juste pour mémoire)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989340_182178413","id":"20210120-160049_719614706","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27273","dateFinished":"2021-01-22T12:46:10+0000","dateStarted":"2021-01-22T12:46:10+0000"},{"text":" val schemaEventTrans =  StructType(\n    Seq(\n    StructField(name = \"EventId\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Day\", dataType = DoubleType, nullable = false),\n      StructField(name = \"MonthYear\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Year\", dataType = DoubleType, nullable = false),\n      StructField(name = \"FractionDate\", dataType = DoubleType, nullable = false),\n\n      StructField(name = \"Actor1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Name\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1CountryCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1KnownGroupCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1EthnicCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Religion1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Religion2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Type1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Type2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Type3Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Name\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2CountryCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2KnownGroupCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2EthnicCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Religion1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Religion2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Type1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Type2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Type3Code\", dataType = StringType, nullable = true),\n      \n      StructField(name = \"IsRootEvent\", dataType = DoubleType, nullable = false),\n      StructField(name = \"EventCode\", dataType = DoubleType, nullable = false),\n      StructField(name = \"EventBaseCode\", dataType = DoubleType, nullable = false),\n      StructField(name = \"EventRootCode\", dataType = DoubleType, nullable = false),\n      StructField(name = \"QuadClass\", dataType = DoubleType, nullable = false),\n      StructField(name = \"GoldsteinScale\", dataType = DoubleType, nullable = false),\n      StructField(name = \"NumMentions\", dataType = DoubleType, nullable = false),\n      StructField(name = \"NumSources\", dataType = DoubleType, nullable = false),\n      StructField(name = \"NumArticles\", dataType = DoubleType, nullable = false),\n      StructField(name = \"AvgTone\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Actor1Geo_Type\", dataType = DoubleType, nullable = false),\n      \n      StructField(name = \"Actor1Geo_FullName\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Geo_CountryCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Geo_ADM1Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor1Geo_ADM2Code\", dataType = StringType, nullable = true),\n      \n      \n      \n      StructField(name = \"Actor1Geo_Lat\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Actor1Geo_Long\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Actor1Geo_FeatureID\", dataType =  StringType, nullable = true),\n     \n      StructField(name = \"Actor2Geo_Type\", dataType = IntegerType, nullable = false),\n      StructField(name = \"Actor2Geo_FullName\", dataType = StringType, nullable = true),\n      \n      \n      \n      StructField(name = \"Actor2Geo_CountryCode\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Geo_ADM1Code\", dataType = StringType, nullable = true),\n      \n      StructField(name = \"Actor2Geo_ADM2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"Actor2Geo_Lat\", dataType = DoubleType, nullable = false),\n      \n      \n      \n      StructField(name = \"Actor2Geo_Long\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Actor2Geo_FeatureID\", dataType = StringType, nullable = true),\n      \n      StructField(name = \"ActionGeo_Type\", dataType = DoubleType, nullable = false),\n      StructField(name = \"ActionGeo_FullName\", dataType = StringType, nullable = true),\n      StructField(name = \"ActionGeo_CountryCode\", dataType = StringType, nullable = true),\n      StructField(name = \"ActionGeo_ADM1Code\", dataType = StringType, nullable = true),\n      \n      StructField(name = \"ActionGeo_ADM2Code\", dataType = StringType, nullable = true),\n      StructField(name = \"ActionGeo_Lat\", dataType = DoubleType, nullable = false),\n      \n      \n      StructField(name = \"ActionGeo_Long\", dataType = DoubleType, nullable = false),\n      StructField(name = \"ActionGeo_FeatureID\", dataType = StringType, nullable = true),\n      StructField(name = \"DATEADDED\", dataType = DoubleType, nullable = false),\n      StructField(name = \"SOURCEURL\", dataType = StringType, nullable = true)\n    )\n  )","user":"anonymous","dateUpdated":"2021-01-22T10:17:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schemaEventTrans: org.apache.spark.sql.types.StructType = StructType(StructField(EventId,DoubleType,false), StructField(Day,DoubleType,false), StructField(MonthYear,DoubleType,false), StructField(Year,DoubleType,false), StructField(FractionDate,DoubleType,false), StructField(Actor1Code,StringType,true), StructField(Actor1Name,StringType,true), StructField(Actor1CountryCode,StringType,true), StructField(Actor1KnownGroupCode,StringType,true), StructField(Actor1EthnicCode,StringType,true), StructField(Actor1Religion1Code,StringType,true), StructField(Actor1Religion2Code,StringType,true), StructField(Actor1Type1Code,StringType,true), StructField(Actor1Type2Code,StringType,true), StructField(Actor1Type3Code,StringType,true), StructField(Actor2Code,StringType,true), StructField(Actor2Name,Str..."}]},"apps":[],"jobName":"paragraph_1611309989340_582284274","id":"20210120-155912_651330270","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27274"},{"text":"val schemaMentionTrans =  StructType(\n    Seq(\n      StructField(name = \"GlobalEventID\", dataType = DoubleType, nullable = false),\n      StructField(name = \"EventTimeDate\", dataType = DoubleType, nullable = false),\n      StructField(name = \"MentionTimeDate\", dataType = DoubleType, nullable = false),\n      StructField(name = \"MentionType\", dataType = IntegerType, nullable = false),\n      StructField(name = \"MentionSourceName\", dataType = StringType, nullable = true),\n      StructField(name = \"MentionIdentifier\", dataType = StringType, nullable = true),\n      StructField(name = \"SentenceID\", dataType = IntegerType, nullable = false),\n      StructField(name = \"Actor1CharOffset\", dataType = IntegerType, nullable = false),\n      StructField(name = \"Actor2CharOffset\", dataType = DoubleType, nullable = false),\n      StructField(name = \"ActionCharOffset\", dataType = IntegerType, nullable = false),\n      StructField(name = \"InRawText\", dataType = DoubleType, nullable = false),\n      StructField(name = \"Confidence\", dataType = IntegerType, nullable = false),\n      StructField(name = \"MentionDocLen\", dataType = IntegerType, nullable = false),\n      StructField(name = \"MentionDocTone\", dataType = DoubleType, nullable = false),\n      StructField(name = \"MentionDocTranslationInfo\", dataType = StringType, nullable = true),\n      StructField(name = \"Extras\", dataType = StringType, nullable = true)\n    )\n  )","user":"anonymous","dateUpdated":"2021-01-22T10:17:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schemaMentionTrans: org.apache.spark.sql.types.StructType = StructType(StructField(GlobalEventID,DoubleType,false), StructField(EventTimeDate,DoubleType,false), StructField(MentionTimeDate,DoubleType,false), StructField(MentionType,IntegerType,false), StructField(MentionSourceName,StringType,true), StructField(MentionIdentifier,StringType,true), StructField(SentenceID,IntegerType,false), StructField(Actor1CharOffset,IntegerType,false), StructField(Actor2CharOffset,DoubleType,false), StructField(ActionCharOffset,IntegerType,false), StructField(InRawText,DoubleType,false), StructField(Confidence,IntegerType,false), StructField(MentionDocLen,IntegerType,false), StructField(MentionDocTone,DoubleType,false), StructField(MentionDocTranslationInfo,StringType,true), StructField(Extras,StringTyp..."}]},"apps":[],"jobName":"paragraph_1611309989340_-794389581","id":"20210120-160427_1676037837","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27275"},{"text":"%md\n## Lecture des buckets S3 au format .CSV et non .zip","user":"anonymous","dateUpdated":"2021-01-22T12:47:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Lecture des buckets S3 au format .CSV et non .zip</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989340_1783058332","id":"20210120-125108_1300214109","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27276","dateFinished":"2021-01-22T12:47:06+0000","dateStarted":"2021-01-22T12:47:06+0000"},{"text":"val df_events = spark.read.options(Map(\"delimiter\"->\"\\t\")).schema(encoderSchemaEvent).csv(\"s3://rods3/[0-9]*.export.CSV\")\ndf_events.show(2, truncate=200, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T10:45:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID         | 962219499                                                                                                     \n SQLDATE               | 20200102                                                                                                      \n MonthYear             | 202001                                                                                                        \n Year                  | 2020                                                                                                          \n FractionDate          | 2020.0055                                                                                                     \n Actor1Code            | USA                                                                                                           \n Actor1Name            | UNITED STATES                                                                                                 \n Actor1CountryCode     | USA                                                                                                           \n Actor1KnownGroupCode  | null                                                                                                          \n Actor1EthnicCode      | null                                                                                                          \n Actor1Religion1Code   | null                                                                                                          \n Actor1Religion2Code   | null                                                                                                          \n Actor1Type1Code       | null                                                                                                          \n Actor1Type2Code       | null                                                                                                          \n Actor1Type3Code       | null                                                                                                          \n Actor2Code            | null                                                                                                          \n Actor2Name            | null                                                                                                          \n Actor2CountryCode     | null                                                                                                          \n Actor2KnownGroupCode  | null                                                                                                          \n Actor2EthnicCode      | null                                                                                                          \n Actor2Religion1Code   | null                                                                                                          \n Actor2Religion2Code   | null                                                                                                          \n Actor2Type1Code       | null                                                                                                          \n Actor2Type2Code       | null                                                                                                          \n Actor2Type3Code       | null                                                                                                          \n IsRootEvent           | 1                                                                                                             \n EventCode             | 111                                                                                                           \n EventBaseCode         | 111                                                                                                           \n EventRootCode         | 11                                                                                                            \n QuadClass             | 3                                                                                                             \n GoldsteinScale        | -2.0                                                                                                          \n NumMentions           | 4                                                                                                             \n NumSources            | 1                                                                                                             \n NumArticles           | 4                                                                                                             \n AvgTone               | -4.68227424749164                                                                                             \n Actor1Geo_Type        | 3                                                                                                             \n Actor1Geo_FullName    | Blacksburg, Virginia, United States                                                                           \n Actor1Geo_CountryCode | US                                                                                                            \n Actor1Geo_ADM1Code    | USVA                                                                                                          \n Actor1Geo_ADM2Code    | VA163                                                                                                         \n Actor1Geo_Lat         | 37.8187                                                                                                       \n Actor1Geo_Long        | -79.3192                                                                                                      \n Actor1Geo_FeatureID   | 1481840                                                                                                       \n Actor2Geo_Type        | 0                                                                                                             \n Actor2Geo_FullName    | null                                                                                                          \n Actor2Geo_CountryCode | null                                                                                                          \n Actor2Geo_ADM1Code    | null                                                                                                          \n Actor2Geo_ADM2Code    | null                                                                                                          \n Actor2Geo_Lat         | null                                                                                                          \n Actor2Geo_Long        | null                                                                                                          \n Actor2Geo_FeatureID   | null                                                                                                          \n ActionGeo_Type        | 3                                                                                                             \n ActionGeo_FullName    | Blacksburg, Virginia, United States                                                                           \n ActionGeo_CountryCode | US                                                                                                            \n ActionGeo_ADM1Code    | USVA                                                                                                          \n ActionGeo_ADM2Code    | VA163                                                                                                         \n ActionGeo_Lat         | 37.8187                                                                                                       \n ActionGeo_Long        | -79.3192                                                                                                      \n ActionGeo_FeatureID   | 1481840                                                                                                       \n DATEADDED             | 20210101000000                                                                                                \n SOURCEURL             | https://www.splicetoday.com/writing/looking-back-at-the-virginia-quarterly-review-tragedy-in-charlottesville  \n-RECORD 1------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID         | 962219500                                                                                                     \n SQLDATE               | 20201202                                                                                                      \n MonthYear             | 202012                                                                                                        \n Year                  | 2020                                                                                                          \n FractionDate          | 2020.9096                                                                                                     \n Actor1Code            | AUS                                                                                                           \n Actor1Name            | AUSTRALIA                                                                                                     \n Actor1CountryCode     | AUS                                                                                                           \n Actor1KnownGroupCode  | null                                                                                                          \n Actor1EthnicCode      | null                                                                                                          \n Actor1Religion1Code   | null                                                                                                          \n Actor1Religion2Code   | null                                                                                                          \n Actor1Type1Code       | null                                                                                                          \n Actor1Type2Code       | null                                                                                                          \n Actor1Type3Code       | null                                                                                                          \n Actor2Code            | null                                                                                                          \n Actor2Name            | null                                                                                                          \n Actor2CountryCode     | null                                                                                                          \n Actor2KnownGroupCode  | null                                                                                                          \n Actor2EthnicCode      | null                                                                                                          \n Actor2Religion1Code   | null                                                                                                          \n Actor2Religion2Code   | null                                                                                                          \n Actor2Type1Code       | null                                                                                                          \n Actor2Type2Code       | null                                                                                                          \n Actor2Type3Code       | null                                                                                                          \n IsRootEvent           | 1                                                                                                             \n EventCode             | 030                                                                                                           \n EventBaseCode         | 030                                                                                                           \n EventRootCode         | 03                                                                                                            \n QuadClass             | 1                                                                                                             \n GoldsteinScale        | 4.0                                                                                                           \n NumMentions           | 4                                                                                                             \n NumSources            | 1                                                                                                             \n NumArticles           | 4                                                                                                             \n AvgTone               | 0.70754716981132                                                                                              \n Actor1Geo_Type        | 4                                                                                                             \n Actor1Geo_FullName    | Sydney, New South Wales, Australia                                                                            \n Actor1Geo_CountryCode | AS                                                                                                            \n Actor1Geo_ADM1Code    | AS02                                                                                                          \n Actor1Geo_ADM2Code    | 154637                                                                                                        \n Actor1Geo_Lat         | -33.8833                                                                                                      \n Actor1Geo_Long        | 151.217                                                                                                       \n Actor1Geo_FeatureID   | -1603135                                                                                                      \n Actor2Geo_Type        | 0                                                                                                             \n Actor2Geo_FullName    | null                                                                                                          \n Actor2Geo_CountryCode | null                                                                                                          \n Actor2Geo_ADM1Code    | null                                                                                                          \n Actor2Geo_ADM2Code    | null                                                                                                          \n Actor2Geo_Lat         | null                                                                                                          \n Actor2Geo_Long        | null                                                                                                          \n Actor2Geo_FeatureID   | null                                                                                                          \n ActionGeo_Type        | 4                                                                                                             \n ActionGeo_FullName    | Sydney, New South Wales, Australia                                                                            \n ActionGeo_CountryCode | AS                                                                                                            \n ActionGeo_ADM1Code    | AS02                                                                                                          \n ActionGeo_ADM2Code    | 154637                                                                                                        \n ActionGeo_Lat         | -33.8833                                                                                                      \n ActionGeo_Long        | 151.217                                                                                                       \n ActionGeo_FeatureID   | -1603135                                                                                                      \n DATEADDED             | 20210101000000                                                                                                \n SOURCEURL             | https://www.dailymail.co.uk/news/article-9103275/Swim-teacher-barred-three-clubs-Gold-Coast-large-tattoo.html \nonly showing top 2 rows\n\ndf_events: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: int, SQLDATE: int ... 59 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=84","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=85"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611309989340_-1134972598","id":"20210120-012910_2005880870","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:45:57+0000","dateFinished":"2021-01-22T10:45:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27277"},{"text":"val df_mentions = spark.read.options(Map(\"delimiter\"->\"\\t\")).schema(encoderSchemaMention).csv(\"s3://rods3/[0-9]*.mentions.CSV\")\ndf_mentions.show(5, truncate=200, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T10:46:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0-----------------------------------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID             | 962314931                                                                                                                              \n EventTimeDate             | 20210101220000                                                                                                                         \n MentionTimeDate           | 20210101220000                                                                                                                         \n MentionType               | 1                                                                                                                                      \n MentionSourceName         | allafrica.com                                                                                                                          \n MentionIdentifier         | https://allafrica.com/stories/202101010033.html                                                                                        \n SentenceID                | 12                                                                                                                                     \n Actor1CharOffset          | -1.0                                                                                                                                   \n Actor2CharOffset          | 3685.0                                                                                                                                 \n ActionCharOffset          | 3763.0                                                                                                                                 \n InRawText                 | 1                                                                                                                                      \n Confidence                | 100                                                                                                                                    \n MentionDocLen             | 6725                                                                                                                                   \n MentionDocTone            | 1.31950989632422                                                                                                                       \n MentionDocTranslationInfo | null                                                                                                                                   \n Extras                    | null                                                                                                                                   \n-RECORD 1-----------------------------------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID             | 962314932                                                                                                                              \n EventTimeDate             | 20210101220000                                                                                                                         \n MentionTimeDate           | 20210101220000                                                                                                                         \n MentionType               | 1                                                                                                                                      \n MentionSourceName         | allafrica.com                                                                                                                          \n MentionIdentifier         | https://allafrica.com/stories/202101010033.html                                                                                        \n SentenceID                | 12                                                                                                                                     \n Actor1CharOffset          | 3685.0                                                                                                                                 \n Actor2CharOffset          | -1.0                                                                                                                                   \n ActionCharOffset          | 3763.0                                                                                                                                 \n InRawText                 | 1                                                                                                                                      \n Confidence                | 100                                                                                                                                    \n MentionDocLen             | 6725                                                                                                                                   \n MentionDocTone            | 1.31950989632422                                                                                                                       \n MentionDocTranslationInfo | null                                                                                                                                   \n Extras                    | null                                                                                                                                   \n-RECORD 2-----------------------------------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID             | 962314933                                                                                                                              \n EventTimeDate             | 20210101220000                                                                                                                         \n MentionTimeDate           | 20210101220000                                                                                                                         \n MentionType               | 1                                                                                                                                      \n MentionSourceName         | sandiegouniontribune.com                                                                                                               \n MentionIdentifier         | https://www.sandiegouniontribune.com/news/environment/story/2021-01-01/what-could-new-u-s-climate-change-policy-mean-for-san-diego     \n SentenceID                | 11                                                                                                                                     \n Actor1CharOffset          | 3074.0                                                                                                                                 \n Actor2CharOffset          | -1.0                                                                                                                                   \n ActionCharOffset          | 3126.0                                                                                                                                 \n InRawText                 | 1                                                                                                                                      \n Confidence                | 30                                                                                                                                     \n MentionDocLen             | 8265                                                                                                                                   \n MentionDocTone            | -0.38167938931298                                                                                                                      \n MentionDocTranslationInfo | null                                                                                                                                   \n Extras                    | null                                                                                                                                   \n-RECORD 3-----------------------------------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID             | 962288177                                                                                                                              \n EventTimeDate             | 20210101153000                                                                                                                         \n MentionTimeDate           | 20210101220000                                                                                                                         \n MentionType               | 1                                                                                                                                      \n MentionSourceName         | abqjournal.com                                                                                                                         \n MentionIdentifier         | https://www.abqjournal.com/1531877/64k-air-ambulance-tab-shows-limits-of-surprise-billing-law.html                                     \n SentenceID                | 8                                                                                                                                      \n Actor1CharOffset          | 2567.0                                                                                                                                 \n Actor2CharOffset          | 2407.0                                                                                                                                 \n ActionCharOffset          | 2525.0                                                                                                                                 \n InRawText                 | 1                                                                                                                                      \n Confidence                | 100                                                                                                                                    \n MentionDocLen             | 6804                                                                                                                                   \n MentionDocTone            | -0.38204393505253                                                                                                                      \n MentionDocTranslationInfo | null                                                                                                                                   \n Extras                    | null                                                                                                                                   \n-RECORD 4-----------------------------------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID             | 962314934                                                                                                                              \n EventTimeDate             | 20210101220000                                                                                                                         \n MentionTimeDate           | 20210101220000                                                                                                                         \n MentionType               | 1                                                                                                                                      \n MentionSourceName         | newscentermaine.com                                                                                                                    \n MentionIdentifier         | https://www.newscentermaine.com/article/news/local/portland/new-years-polar-plunges-put-on-ice/97-1586878e-425d-46ee-9154-5d3a2f873356 \n SentenceID                | 2                                                                                                                                      \n Actor1CharOffset          | 436.0                                                                                                                                  \n Actor2CharOffset          | 456.0                                                                                                                                  \n ActionCharOffset          | 466.0                                                                                                                                  \n InRawText                 | 1                                                                                                                                      \n Confidence                | 50                                                                                                                                     \n MentionDocLen             | 2311                                                                                                                                   \n MentionDocTone            | 2.4330900243309                                                                                                                        \n MentionDocTranslationInfo | null                                                                                                                                   \n Extras                    | null                                                                                                                                   \nonly showing top 5 rows\n\ndf_mentions: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: decimal(38,0), EventTimeDate: decimal(38,0) ... 14 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=86","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=87"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611309989341_492948131","id":"20210120-153626_1584983797","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T10:46:15+0000","dateFinished":"2021-01-22T10:46:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27278"},{"text":"val df_gkg = spark.read.options(Map(\"delimiter\"->\"\\t\")).schema(encoderSchemaGkG).csv(\"s3://rods3/[0-9]*.gkg.csv\")\ndf_gkg.show(5, truncate=200, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T10:46:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID                | 20210102111500-T0                                                                                                                                                                                        \n DATE                       | 20210102111500                                                                                                                                                                                           \n SourceCollectionIdentifier | 1                                                                                                                                                                                                        \n SourceCommonName           | finexpert.e15.cz                                                                                                                                                                                         \n DocumentIdentifier         | https://forum.finexpert.e15.cz/./viewtopic.php?f=312&p=12772184                                                                                                                                          \n Counts                     | null                                                                                                                                                                                                     \n V2Counts                   | null                                                                                                                                                                                                     \n Themes                     | ECON_WORLDCURRENCIES;ECON_WORLDCURRENCIES_DOLLARS;TAX_ETHNICITY;TAX_ETHNICITY_CZECH;TAX_WORLDLANGUAGES;TAX_WORLDLANGUAGES_CZECH;ECON_INFLATION;WB_1104_MACROECONOMIC_VULNERABILITY_AND_DEBT;WB_442_IN... \n V2Themes                   | TAX_ETHNICITY_CZECH,616;TAX_WORLDLANGUAGES_CZECH,616;ECON_WORLDCURRENCIES_DOLLARS,550;ECON_INFLATION,706;WB_1104_MACROECONOMIC_VULNERABILITY_AND_DEBT,706;WB_442_INFLATION,706;                          \n Locations                  | 1#Czech Republic#EZ#EZ#49.75#15#EZ                                                                                                                                                                       \n V2Locations                | 1#Czech#EZ#EZ##49.75#15#EZ#616                                                                                                                                                                           \n Persons                    | null                                                                                                                                                                                                     \n V2Persons                  | null                                                                                                                                                                                                     \n Organizations              | sberbank                                                                                                                                                                                                 \n V2Organizations            | Sberbank,943                                                                                                                                                                                             \n V2Tone                     | -0.641025641025641,2.56410256410256,3.2051282051282,5.76923076923077,21.7948717948718,0.641025641025641,142                                                                                              \n Dates                      | null                                                                                                                                                                                                     \n GCAM                       | wc:142,c1.2:1,c12.1:6,c12.10:12,c12.12:2,c12.13:6,c12.14:4,c12.3:1,c12.4:1,c12.5:4,c12.7:3,c12.8:7,c12.9:7,c13.12:1,c13.2:1,c13.3:1,c13.4:1,c14.1:5,c14.10:5,c14.11:10,c14.2:12,c14.3:7,c14.5:14,c14.... \n SharingImage               | https://forum.finexpert.e15.cz/ogimage.jpg                                                                                                                                                               \n RelatedImages              | null                                                                                                                                                                                                     \n SocialImageEmbeds          | null                                                                                                                                                                                                     \n SocialVideoEmbeds          | null                                                                                                                                                                                                     \n Quotations                 | null                                                                                                                                                                                                     \n AllNames                   | Currency Diversification,30;Currency Diversification,89;Czech Market,628;Users Are Going,873                                                                                                             \n Amounts                    | 47,hello,259;100000,amount,386;                                                                                                                                                                          \n TranslationInfo            | srclc:ces;eng:Moses 2.1.1 / MosesCore Europarl cs-en / GT-CES 1.0                                                                                                                                        \n Extras                     | <PAGE_LINKS>https://forum.finexpert.e15.cz/././memberlist.php;https://forum.finexpert.e15.cz/././memberlist.php?mode=viewprofile&u=191087;https://forum.finexpert.e15.cz/././viewtopic.php?f=312&t=13... \n Year                       | null                                                                                                                                                                                                     \n Month                      | null                                                                                                                                                                                                     \n Day                        | null                                                                                                                                                                                                     \n-RECORD 1------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID                | 20210102111500-T1                                                                                                                                                                                        \n DATE                       | 20210102111500                                                                                                                                                                                           \n SourceCollectionIdentifier | 1                                                                                                                                                                                                        \n SourceCommonName           | finexpert.e15.cz                                                                                                                                                                                         \n DocumentIdentifier         | https://forum.finexpert.e15.cz/./viewtopic.php?f=316&t=1185255&p=12772133                                                                                                                                \n Counts                     | null                                                                                                                                                                                                     \n V2Counts                   | null                                                                                                                                                                                                     \n Themes                     | TAX_FNCACT;TAX_FNCACT_FOOL;TAX_ETHNICITY;TAX_ETHNICITY_DIMES;GEN_HOLIDAY;CORRUPTION;TAX_ETHNICITY_INDONESIAN;TAX_WORLDLANGUAGES;TAX_WORLDLANGUAGES_INDONESIAN;                                           \n V2Themes                   | GEN_HOLIDAY,821;TAX_ETHNICITY_INDONESIAN,1653;TAX_WORLDLANGUAGES_INDONESIAN,1653;CORRUPTION,1321;TAX_ETHNICITY_DIMES,365;TAX_FNCACT_FOOL,109;                                                            \n Locations                  | null                                                                                                                                                                                                     \n V2Locations                | null                                                                                                                                                                                                     \n Persons                    | null                                                                                                                                                                                                     \n V2Persons                  | null                                                                                                                                                                                                     \n Organizations              | sberbank                                                                                                                                                                                                 \n V2Organizations            | Sberbank,9;Sberbank,40;Sberbank,1567                                                                                                                                                                     \n V2Tone                     | -2.22222222222222,0.952380952380952,3.17460317460317,4.12698412698413,22.5396825396825,1.26984126984127,289                                                                                              \n Dates                      | null                                                                                                                                                                                                     \n GCAM                       | wc:289,c12.1:21,c12.10:28,c12.12:4,c12.13:12,c12.14:15,c12.3:9,c12.4:4,c12.5:10,c12.7:13,c12.8:16,c12.9:20,c14.1:11,c14.10:6,c14.11:16,c14.2:18,c14.3:18,c14.5:22,c14.7:4,c14.9:5,c15.10:1,c15.103:2,... \n SharingImage               | https://forum.finexpert.e15.cz/ogimage.jpg                                                                                                                                                               \n RelatedImages              | null                                                                                                                                                                                                     \n SocialImageEmbeds          | null                                                                                                                                                                                                     \n SocialVideoEmbeds          | null                                                                                                                                                                                                     \n Quotations                 | null                                                                                                                                                                                                     \n AllNames                   | Everything Sberbank,1593;Survive The,1647;Indonesian Island Bata,1691                                                                                                                                    \n Amounts                    | null                                                                                                                                                                                                     \n TranslationInfo            | srclc:ces;eng:Moses 2.1.1 / MosesCore Europarl cs-en / GT-CES 1.0                                                                                                                                        \n Extras                     | <PAGE_TITLE>Sberbank CZ - FinExpert.cz</PAGE_TITLE>                                                                                                                                                      \n Year                       | null                                                                                                                                                                                                     \n Month                      | null                                                                                                                                                                                                     \n Day                        | null                                                                                                                                                                                                     \n-RECORD 2------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID                | 20210102111500-T2                                                                                                                                                                                        \n DATE                       | 20210102111500                                                                                                                                                                                           \n SourceCollectionIdentifier | 1                                                                                                                                                                                                        \n SourceCommonName           | nedd.tiscali.cz                                                                                                                                                                                          \n DocumentIdentifier         | https://nedd.tiscali.cz/nejbizarnejsi-ptak-sveta-prezije-rok-2100-500595                                                                                                                                 \n Counts                     | null                                                                                                                                                                                                     \n V2Counts                   | null                                                                                                                                                                                                     \n Themes                     | TAX_ETHNICITY;TAX_ETHNICITY_INDONESIAN;TAX_WORLDLANGUAGES;TAX_WORLDLANGUAGES_INDONESIAN;TAX_POLITICAL_PARTY;TAX_POLITICAL_PARTY_REPUBLICAN;USPEC_POLITICS_GENERAL1;TAX_FNCACT;TAX_FNCACT_SUPPORTER;EP... \n V2Themes                   | GENERAL_HEALTH,1990;MEDICAL,1990;TAX_ETHNICITY_CZECH,581;TAX_WORLDLANGUAGES_CZECH,581;WB_566_ENVIRONMENT_AND_NATURAL_RESOURCES,1834;WB_1777_FORESTS,1834;WB_590_ECOSYSTEMS,1834;TAX_FNCACT_SUPPORTER,... \n Locations                  | 1#Czech Republic#EZ#EZ#49.75#15#EZ;1#Indonesia#ID#ID#-5#120#ID                                                                                                                                           \n V2Locations                | 1#Indonesian#ID#ID##-5#120#ID#77;1#Czech#EZ#EZ##49.75#15#EZ#581                                                                                                                                          \n Persons                    | vladimir ilyich lenin;charles lucien bonaparte                                                                                                                                                           \n V2Persons                  | Vladimir Ilyich Lenin,549;Charles Lucien Bonaparte,342                                                                                                                                                   \n Organizations              | null                                                                                                                                                                                                     \n V2Organizations            | null                                                                                                                                                                                                     \n V2Tone                     | 1.1142061281337,3.06406685236769,1.94986072423398,5.01392757660167,25.0696378830084,0.835654596100279,336                                                                                                \n Dates                      | null                                                                                                                                                                                                     \n GCAM                       | wc:336,c1.1:2,c1.3:2,c12.1:20,c12.10:39,c12.12:5,c12.13:18,c12.14:18,c12.3:7,c12.4:5,c12.5:11,c12.7:12,c12.8:23,c12.9:28,c13.12:2,c14.1:29,c14.10:21,c14.11:37,c14.2:18,c14.3:25,c14.4:9,c14.5:35,c14... \n SharingImage               | https://im.tiscali.cz/nedd/2020/11/30/1242045-wilson-s_bird_of_paradise_best-base_16x9.jpg.1152?1606759515.0                                                                                             \n RelatedImages              | null                                                                                                                                                                                                     \n SocialImageEmbeds          | null                                                                                                                                                                                                     \n SocialVideoEmbeds          | https://youtube.com/embed/_qohoG3euFY;                                                                                                                                                                   \n Quotations                 | null                                                                                                                                                                                                     \n AllNames                   | Survive The,46;Indonesian Island,85;Charles Lucien Bonaparte,349;Vladimir Ilyich Lenin,560;Light Ray,1231                                                                                                \n Amounts                    | null                                                                                                                                                                                                     \n TranslationInfo            | srclc:ces;eng:Moses 2.1.1 / MosesCore Europarl cs-en / GT-CES 1.0                                                                                                                                        \n Extras                     | <PAGE_TITLE>Nejbizarn&#x11B;j&#x161;&#xED; pt&#xE1;k sv&#x11B;ta. P&#x159;e&#x17E;ije rok 2100?</PAGE_TITLE>                                                                                             \n Year                       | null                                                                                                                                                                                                     \n Month                      | null                                                                                                                                                                                                     \n Day                        | null                                                                                                                                                                                                     \n-RECORD 3------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID                | 20210102111500-T3                                                                                                                                                                                        \n DATE                       | 20210102111500                                                                                                                                                                                           \n SourceCollectionIdentifier | 1                                                                                                                                                                                                        \n SourceCommonName           | finexpert.e15.cz                                                                                                                                                                                         \n DocumentIdentifier         | https://forum.finexpert.e15.cz/./viewtopic.php?f=319&p=12772160                                                                                                                                          \n Counts                     | null                                                                                                                                                                                                     \n V2Counts                   | null                                                                                                                                                                                                     \n Themes                     | GENERAL_HEALTH;MEDICAL;ECON_TAXATION;USPEC_POLICY1;EPU_POLICY;EPU_POLICY_TAX;EPU_CATS_TAXES;WB_1973_FINANCIAL_RISK_REDUCTION;WB_435_AGRICULTURE_AND_FOOD_SECURITY;WB_337_INSURANCE;WB_1967_AGRICULTUR... \n V2Themes                   | GENERAL_GOVERNMENT,377;EPU_POLICY_GOVERNMENT,377;GENERAL_HEALTH,44;GENERAL_HEALTH,281;GENERAL_HEALTH,721;MEDICAL,44;MEDICAL,281;MEDICAL,721;CRISISLEX_T11_UPDATESSYMPATHY,899;TAX_FNCACT_SELF_EMPLOYE... \n Locations                  | null                                                                                                                                                                                                     \n V2Locations                | null                                                                                                                                                                                                     \n Persons                    | null                                                                                                                                                                                                     \n V2Persons                  | null                                                                                                                                                                                                     \n Organizations              | null                                                                                                                                                                                                     \n V2Organizations            | null                                                                                                                                                                                                     \n V2Tone                     | 1.16959064327485,4.67836257309941,3.50877192982456,8.18713450292398,18.1286549707602,2.33918128654971,158                                                                                                \n Dates                      | null                                                                                                                                                                                                     \n GCAM                       | wc:158,c12.1:13,c12.10:21,c12.12:8,c12.13:9,c12.14:4,c12.3:5,c12.4:2,c12.5:9,c12.7:13,c12.8:11,c12.9:12,c13.12:1,c14.1:8,c14.10:6,c14.11:14,c14.2:6,c14.3:13,c14.4:4,c14.5:19,c14.6:1,c14.7:4,c14.9:1... \n SharingImage               | https://forum.finexpert.e15.cz/ogimage.jpg                                                                                                                                                               \n RelatedImages              | null                                                                                                                                                                                                     \n SocialImageEmbeds          | null                                                                                                                                                                                                     \n SocialVideoEmbeds          | null                                                                                                                                                                                                     \n Quotations                 | null                                                                                                                                                                                                     \n AllNames                   | null                                                                                                                                                                                                     \n Amounts                    | 1000000,kronor is subject,395;                                                                                                                                                                           \n TranslationInfo            | srclc:ces;eng:Moses 2.1.1 / MosesCore Europarl cs-en / GT-CES 1.0                                                                                                                                        \n Extras                     | <PAGE_TITLE>P&#x159;&#xED;jmy z kurzov&#xFD;ch s&#xE1;zek - FinExpert.cz</PAGE_TITLE>                                                                                                                    \n Year                       | null                                                                                                                                                                                                     \n Month                      | null                                                                                                                                                                                                     \n Day                        | null                                                                                                                                                                                                     \n-RECORD 4------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID                | 20210102111500-T4                                                                                                                                                                                        \n DATE                       | 20210102111500                                                                                                                                                                                           \n SourceCollectionIdentifier | 1                                                                                                                                                                                                        \n SourceCommonName           | finexpert.e15.cz                                                                                                                                                                                         \n DocumentIdentifier         | https://forum.finexpert.e15.cz/./viewtopic.php?f=319&t=1313131&p=12772160                                                                                                                                \n Counts                     | null                                                                                                                                                                                                     \n V2Counts                   | null                                                                                                                                                                                                     \n Themes                     | GENERAL_HEALTH;MEDICAL;ECON_TAXATION;USPEC_POLICY1;EPU_POLICY;EPU_POLICY_TAX;EPU_CATS_TAXES;WB_1973_FINANCIAL_RISK_REDUCTION;WB_435_AGRICULTURE_AND_FOOD_SECURITY;WB_337_INSURANCE;WB_1967_AGRICULTUR... \n V2Themes                   | GENERAL_GOVERNMENT,377;EPU_POLICY_GOVERNMENT,377;GENERAL_HEALTH,44;GENERAL_HEALTH,281;GENERAL_HEALTH,721;MEDICAL,44;MEDICAL,281;MEDICAL,721;CRISISLEX_T11_UPDATESSYMPATHY,899;TAX_FNCACT_SELF_EMPLOYE... \n Locations                  | null                                                                                                                                                                                                     \n V2Locations                | null                                                                                                                                                                                                     \n Persons                    | null                                                                                                                                                                                                     \n V2Persons                  | null                                                                                                                                                                                                     \n Organizations              | null                                                                                                                                                                                                     \n V2Organizations            | null                                                                                                                                                                                                     \n V2Tone                     | 1.13636363636364,4.54545454545455,3.40909090909091,7.95454545454545,17.6136363636364,2.27272727272727,163                                                                                                \n Dates                      | null                                                                                                                                                                                                     \n GCAM                       | wc:163,c12.1:13,c12.10:21,c12.12:8,c12.13:9,c12.14:4,c12.3:5,c12.4:2,c12.5:9,c12.7:13,c12.8:11,c12.9:12,c13.12:1,c14.1:8,c14.10:6,c14.11:14,c14.2:7,c14.3:13,c14.4:4,c14.5:19,c14.6:1,c14.7:4,c14.9:1... \n SharingImage               | https://forum.finexpert.e15.cz/ogimage.jpg                                                                                                                                                               \n RelatedImages              | null                                                                                                                                                                                                     \n SocialImageEmbeds          | null                                                                                                                                                                                                     \n SocialVideoEmbeds          | null                                                                                                                                                                                                     \n Quotations                 | null                                                                                                                                                                                                     \n AllNames                   | null                                                                                                                                                                                                     \n Amounts                    | 1000000,kronor is subject,395;                                                                                                                                                                           \n TranslationInfo            | srclc:ces;eng:Moses 2.1.1 / MosesCore Europarl cs-en / GT-CES 1.0                                                                                                                                        \n Extras                     | <PAGE_TITLE>P&#x159;&#xED;jmy z kurzov&#xFD;ch s&#xE1;zek - FinExpert.cz</PAGE_TITLE>                                                                                                                    \n Year                       | null                                                                                                                                                                                                     \n Month                      | null                                                                                                                                                                                                     \n Day                        | null                                                                                                                                                                                                     \nonly showing top 5 rows\n\ndf_gkg: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, DATE: decimal(38,0) ... 28 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=88","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=89"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611310917790_814680341","id":"20210122-102157_429566387","dateCreated":"2021-01-22T10:21:57+0000","dateStarted":"2021-01-22T10:46:24+0000","dateFinished":"2021-01-22T10:46:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27279"},{"text":"%md\n## Allègement des dataframes en fonction des features identifiées comme utiles dans le use case (requêtes demandées)","user":"anonymous","dateUpdated":"2021-01-22T12:48:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Allègement des dataframes en fonction des features identifiées comme utiles dans le use case (requêtes demandées)</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611312468413_22294213","id":"20210122-104748_849223546","dateCreated":"2021-01-22T10:47:48+0000","dateStarted":"2021-01-22T12:48:08+0000","dateFinished":"2021-01-22T12:48:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27282"},{"text":"val df_events_light = df_events.select(\"GLOBALEVENTID\",\"SQLDATE\",\"MonthYear\",\"Year\",\"NumMentions\",\"SOURCEURL\",\"ActionGeo_CountryCode\")\ndf_events_light.show(2, truncate=400, vertical=true)\n","user":"anonymous","dateUpdated":"2021-01-22T11:22:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID         | 962219499                                                                                                     \n SQLDATE               | 20200102                                                                                                      \n MonthYear             | 202001                                                                                                        \n Year                  | 2020                                                                                                          \n NumMentions           | 4                                                                                                             \n SOURCEURL             | https://www.splicetoday.com/writing/looking-back-at-the-virginia-quarterly-review-tragedy-in-charlottesville  \n ActionGeo_CountryCode | US                                                                                                            \n-RECORD 1------------------------------------------------------------------------------------------------------------------------------\n GLOBALEVENTID         | 962219500                                                                                                     \n SQLDATE               | 20201202                                                                                                      \n MonthYear             | 202012                                                                                                        \n Year                  | 2020                                                                                                          \n NumMentions           | 4                                                                                                             \n SOURCEURL             | https://www.dailymail.co.uk/news/article-9103275/Swim-teacher-barred-three-clubs-Gold-Coast-large-tattoo.html \n ActionGeo_CountryCode | AS                                                                                                            \nonly showing top 2 rows\n\ndf_events_light: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: int, SQLDATE: int ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=94"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611312512389_873471924","id":"20210122-104832_1542232678","dateCreated":"2021-01-22T10:48:32+0000","dateStarted":"2021-01-22T11:22:12+0000","dateFinished":"2021-01-22T11:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27283"},{"text":"val df_mentions_light = df_mentions.select(\"GLOBALEVENTID\",\"MentionDocTranslationInfo\")\ndf_mentions_light.show(2, truncate=400, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T11:36:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0------------------------------\n GLOBALEVENTID             | 962314931 \n MentionDocTranslationInfo | null      \n-RECORD 1------------------------------\n GLOBALEVENTID             | 962314932 \n MentionDocTranslationInfo | null      \nonly showing top 2 rows\n\ndf_mentions_light: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: decimal(38,0), MentionDocTranslationInfo: string]\n"}]},"apps":[],"jobName":"paragraph_1611313081538_125878114","id":"20210122-105801_201631017","dateCreated":"2021-01-22T10:58:01+0000","dateStarted":"2021-01-22T11:36:59+0000","dateFinished":"2021-01-22T11:36:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27284","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=95"],"interpreterSettingId":"spark"}}},{"text":"val df_gkg_light = df_gkg.select(\"GKGRECORDID\",\"DATE\",\"SourceCommonName\",\"Themes\",\"Locations\",\"Persons\",\"V2Tone\")\ndf_gkg_light.show(2, truncate=400, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T11:21:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID      | 20210102111500-T0                                                                                                                                                                                             \n DATE             | 20210102111500                                                                                                                                                                                                \n SourceCommonName | finexpert.e15.cz                                                                                                                                                                                              \n Themes           | ECON_WORLDCURRENCIES;ECON_WORLDCURRENCIES_DOLLARS;TAX_ETHNICITY;TAX_ETHNICITY_CZECH;TAX_WORLDLANGUAGES;TAX_WORLDLANGUAGES_CZECH;ECON_INFLATION;WB_1104_MACROECONOMIC_VULNERABILITY_AND_DEBT;WB_442_INFLATION; \n Locations        | 1#Czech Republic#EZ#EZ#49.75#15#EZ                                                                                                                                                                            \n Persons          | null                                                                                                                                                                                                          \n V2Tone           | -0.641025641025641,2.56410256410256,3.2051282051282,5.76923076923077,21.7948717948718,0.641025641025641,142                                                                                                   \n-RECORD 1-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n GKGRECORDID      | 20210102111500-T1                                                                                                                                                                                             \n DATE             | 20210102111500                                                                                                                                                                                                \n SourceCommonName | finexpert.e15.cz                                                                                                                                                                                              \n Themes           | TAX_FNCACT;TAX_FNCACT_FOOL;TAX_ETHNICITY;TAX_ETHNICITY_DIMES;GEN_HOLIDAY;CORRUPTION;TAX_ETHNICITY_INDONESIAN;TAX_WORLDLANGUAGES;TAX_WORLDLANGUAGES_INDONESIAN;                                                \n Locations        | null                                                                                                                                                                                                          \n Persons          | null                                                                                                                                                                                                          \n V2Tone           | -2.22222222222222,0.952380952380952,3.17460317460317,4.12698412698413,22.5396825396825,1.26984126984127,289                                                                                                   \nonly showing top 2 rows\n\ndf_gkg_light: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, DATE: decimal(38,0) ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=93"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611313604380_337084225","id":"20210122-110644_8727759","dateCreated":"2021-01-22T11:06:44+0000","dateStarted":"2021-01-22T11:21:53+0000","dateFinished":"2021-01-22T11:21:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27285"},{"text":"%md\n## Transfert vers le cluster MongoDB Atlas \nEcriture de 3 collections dans notre BD : Events, mentions et gkg, dans leur version light faite ci-dessus","user":"anonymous","dateUpdated":"2021-01-22T12:49:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Transfert vers le cluster MongoDB Atlas</h2>\n<p>Ecriture de 3 collections dans notre BD : Events, mentions et gkg, dans leur version light faite ci-dessus</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989341_2068345220","id":"20210119-151914_774045665","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T12:49:34+0000","dateFinished":"2021-01-22T12:49:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27286"},{"text":"//MongoSpark.save(df_events_light.write.option(\"spark.mongodb.output.uri\", \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.events?retryWrites=true&w=majority\").mode(\"overwrite\"))\n//MongoSpark.save(df_mentions_light.write.option(\"spark.mongodb.output.uri\", \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.mentions?retryWrites=true&w=majority\").mode(\"overwrite\"))\n//MongoSpark.save(df_gkg_light.write.option(\"spark.mongodb.output.uri\", \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.gkg?retryWrites=true&w=majority\").mode(\"overwrite\"))\n","user":"anonymous","dateUpdated":"2021-01-22T11:48:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mongodb.spark.config._\n"}]},"apps":[],"jobName":"paragraph_1611309989341_-1742010291","id":"20210119-151823_2026515719","dateCreated":"2021-01-22T10:06:29+0000","dateStarted":"2021-01-22T11:37:20+0000","dateFinished":"2021-01-22T11:38:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27287","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=96","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=97","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=98"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611315952206_1591111054","id":"20210122-114552_1854236206","dateCreated":"2021-01-22T11:45:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:33984","text":"%md\n## Lecture / requête de nos collections MongoDB allégées. \n2 jours de data ont été chargées : 495MB pour quota 500MB sur la version Atlas AWS ","dateUpdated":"2021-01-22T12:51:13+0000","dateFinished":"2021-01-22T12:51:13+0000","dateStarted":"2021-01-22T12:51:13+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Lecture / requête de nos collections MongoDB allégées.</h2>\n<p>2 jours de data ont été chargées : 495MB pour quota 500MB sur la version Atlas AWS</p>\n</div>"}]}},{"text":"%md\nOn crée une Mongo ReadConfig qui pointe en lectures la collection souhaitée (.../DBtest/collection_souhaitée)","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On crée une Mongo ReadConfig qui pointe en lectures la collection souhaitée (&hellip;/DBtest/collection_souhaitée)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989342_-17602927","id":"20210120-114625_1235527366","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27288"},{"text":"val readConfigEvents = ReadConfig(Map(\"uri\" ->  \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.events\", \"readPreference.name\" -> \"secondaryPreferred\"))\nval readConfigMentions = ReadConfig(Map(\"uri\" ->  \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.mentions\", \"readPreference.name\" -> \"secondaryPreferred\"))\nval readConfigGkG = ReadConfig(Map(\"uri\" ->  \"mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.gkg\", \"readPreference.name\" -> \"secondaryPreferred\"))","user":"anonymous","dateUpdated":"2021-01-22T11:49:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"readConfigEvents: com.mongodb.spark.config.ReadConfig.Self = ReadConfig(DBtest,events,Some(mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.events),1000,DefaultMongoPartitioner,Map(),15,ReadPreferenceConfig(secondaryPreferred,None),ReadConcernConfig(None),AggregationConfig(None,None,None,true),false,true,250,true,true,10000,None)\nreadConfigMentions: com.mongodb.spark.config.ReadConfig.Self = ReadConfig(DBtest,mentions,Some(mongodb+srv://admin:admin@cluster0.ldu6v.mongodb.net/DBtest.mentions),1000,DefaultMongoPartitioner,Map(),15,ReadPreferenceConfig(secondaryPreferred,None),ReadConcernConfig(None),AggregationConfig(None,None,None,true),false,true,250,true,true,10000,None)\nreadConfigGkG: com.mongodb.spark.config.ReadConfig.Self = ReadConfig(DBtest,gkg,Some(mongodb+srv://admin:..."}]},"apps":[],"jobName":"paragraph_1611309989342_1750291101","id":"20210120-114731_2133781453","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27289","dateFinished":"2021-01-22T11:49:25+0000","dateStarted":"2021-01-22T11:49:25+0000"},{"text":"%md\n\nOn lit les collections du cluster Mongo Atlas avec la méthode load du connecteur MongoSpark.","user":"anonymous","dateUpdated":"2021-01-22T12:52:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On lit les collections du cluster Mongo Atlas avec la méthode load du connecteur MongoSpark.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989342_-47634875","id":"20210120-114802_1163769682","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27290","dateFinished":"2021-01-22T12:52:14+0000","dateStarted":"2021-01-22T12:52:14+0000"},{"text":"val dfE = MongoSpark.load(spark, readConfigEvents).cache\ndfE.show(2, truncate=400, vertical=true)\n","user":"anonymous","dateUpdated":"2021-01-22T11:50:47+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0---------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n ActionGeo_CountryCode | US                                                                                                                                                         \n GLOBALEVENTID         | 962299454                                                                                                                                                  \n MonthYear             | 202012                                                                                                                                                     \n NumMentions           | 1                                                                                                                                                          \n SOURCEURL             | https://www.fauquier.com/news/update-new-covid-19-cases-in-the-state-top-5-000-for-second-day-positivity/article_9ac6a42e-e090-11ea-ae5c-fbba5f1b640e.html \n SQLDATE               | 20201231                                                                                                                                                   \n Year                  | 2020                                                                                                                                                       \n _id                   | [600ab8f123411d13d827697f]                                                                                                                                 \n-RECORD 1---------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n ActionGeo_CountryCode | US                                                                                                                                                         \n GLOBALEVENTID         | 962299460                                                                                                                                                  \n MonthYear             | 202012                                                                                                                                                     \n NumMentions           | 2                                                                                                                                                          \n SOURCEURL             | https://www.fauquier.com/news/update-new-covid-19-cases-in-the-state-top-5-000-for-second-day-positivity/article_9ac6a42e-e090-11ea-ae5c-fbba5f1b640e.html \n SQLDATE               | 20201231                                                                                                                                                   \n Year                  | 2020                                                                                                                                                       \n _id                   | [600ab8f123411d13d8276985]                                                                                                                                 \nonly showing top 2 rows\n\ndfE: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [ActionGeo_CountryCode: string, GLOBALEVENTID: int ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611309989342_1610428977","id":"20210119-152419_1995586545","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27291","dateFinished":"2021-01-22T11:50:53+0000","dateStarted":"2021-01-22T11:50:47+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=100","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=101"],"interpreterSettingId":"spark"}}},{"text":"val dfM = MongoSpark.load(spark, readConfigMentions).cache\ndfM.show(2, truncate=400, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T11:51:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0-----------------------------------------------\n GLOBALEVENTID             | 962311859                  \n MentionDocTranslationInfo | null                       \n _id                       | [600ab8fae0230e6dcca2fd2e] \n-RECORD 1-----------------------------------------------\n GLOBALEVENTID             | 962311860                  \n MentionDocTranslationInfo | null                       \n _id                       | [600ab8fae0230e6dcca2fd3f] \nonly showing top 2 rows\n\ndfM: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: decimal(9,0), MentionDocTranslationInfo: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1611309989342_-1694549468","id":"20210120-115958_1761234422","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27292","dateFinished":"2021-01-22T11:51:15+0000","dateStarted":"2021-01-22T11:51:09+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=102","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=103"],"interpreterSettingId":"spark"}}},{"text":"val dfG = MongoSpark.load(spark, readConfigGkG).cache\ndfM.show(2, truncate=400, vertical=true)","user":"anonymous","dateUpdated":"2021-01-22T11:51:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611314057641_-308830047","id":"20210122-111417_215647861","dateCreated":"2021-01-22T11:14:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27293","dateFinished":"2021-01-22T11:51:39+0000","dateStarted":"2021-01-22T11:51:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0-----------------------------------------------\n GLOBALEVENTID             | 962311859                  \n MentionDocTranslationInfo | null                       \n _id                       | [600ab8fae0230e6dcca2fd2e] \n-RECORD 1-----------------------------------------------\n GLOBALEVENTID             | 962311860                  \n MentionDocTranslationInfo | null                       \n _id                       | [600ab8fae0230e6dcca2fd3f] \nonly showing top 2 rows\n\ndfG: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [DATE: decimal(14,0), GKGRECORDID: string ... 6 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=104","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=105"],"interpreterSettingId":"spark"}}},{"text":"%md\nBasics Spark Dataframes (pour mémoire)","user":"anonymous","dateUpdated":"2021-01-22T12:53:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Basics Spark Dataframes (pour mémoire)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989342_652149720","id":"20210120-113525_801057576","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27294","dateFinished":"2021-01-22T12:53:04+0000","dateStarted":"2021-01-22T12:53:04+0000"},{"text":"dfE.show(2, truncate = 62, vertical = true)\ndfE.printSchema","user":"anonymous","dateUpdated":"2021-01-22T11:52:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-RECORD 0-------------------------------------------------------------------------------\n ActionGeo_CountryCode | US                                                             \n GLOBALEVENTID         | 962299454                                                      \n MonthYear             | 202012                                                         \n NumMentions           | 1                                                              \n SOURCEURL             | https://www.fauquier.com/news/update-new-covid-19-cases-in-... \n SQLDATE               | 20201231                                                       \n Year                  | 2020                                                           \n _id                   | [600ab8f123411d13d827697f]                                     \n-RECORD 1-------------------------------------------------------------------------------\n ActionGeo_CountryCode | US                                                             \n GLOBALEVENTID         | 962299460                                                      \n MonthYear             | 202012                                                         \n NumMentions           | 2                                                              \n SOURCEURL             | https://www.fauquier.com/news/update-new-covid-19-cases-in-... \n SQLDATE               | 20201231                                                       \n Year                  | 2020                                                           \n _id                   | [600ab8f123411d13d8276985]                                     \nonly showing top 2 rows\n\nroot\n |-- ActionGeo_CountryCode: string (nullable = true)\n |-- GLOBALEVENTID: integer (nullable = true)\n |-- MonthYear: integer (nullable = true)\n |-- NumMentions: integer (nullable = true)\n |-- SOURCEURL: string (nullable = true)\n |-- SQLDATE: integer (nullable = true)\n |-- Year: integer (nullable = true)\n |-- _id: struct (nullable = true)\n |    |-- oid: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1611309989342_-99503614","id":"20210120-113513_1742314152","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27296","dateFinished":"2021-01-22T11:52:04+0000","dateStarted":"2021-01-22T11:52:04+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=106"],"interpreterSettingId":"spark"}}},{"text":"println(s\"Nombre de lignes : ${dfE.count}\") \nprintln(s\"Nombre de colonnes : ${dfE.columns.length}\")","user":"anonymous","dateUpdated":"2021-01-22T11:52:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Nombre de lignes : 196252\nNombre de colonnes : 8\n"}]},"apps":[],"jobName":"paragraph_1611309989343_1912880105","id":"20210120-035518_1858104195","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27297","dateFinished":"2021-01-22T11:52:12+0000","dateStarted":"2021-01-22T11:52:12+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=107","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=108"],"interpreterSettingId":"spark"}}},{"text":"dfE.select(\"GLOBALEVENTID\",\"SOURCEURL\").show()","user":"anonymous","dateUpdated":"2021-01-22T11:52:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------+\n|GLOBALEVENTID|           SOURCEURL|\n+-------------+--------------------+\n|    962299454|https://www.fauqu...|\n|    962299460|https://www.fauqu...|\n|    962299476|http://www.colomb...|\n|    962299478|https://www.forbe...|\n|    962299479|https://tulsaworl...|\n|    962299485|https://www.taipe...|\n|    962299492|https://jewishjou...|\n|    962336920|https://www.thewr...|\n|    962336955|https://www.thene...|\n|    962336969|http://www.smetim...|\n|    962336978|https://guardian....|\n|    962299566|https://vestnikka...|\n|    962299570|http://www.riogra...|\n|    962337003|https://www.start...|\n|    962299575|https://www.marin...|\n|    962299583|https://statesvil...|\n|    962299584|https://news.dela...|\n|    962299615|https://www.times...|\n|    962299628|http://www.dailyp...|\n|    962337068|https://www.super...|\n+-------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989343_271978926","id":"20210120-113313_2021857608","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27298","dateFinished":"2021-01-22T11:52:20+0000","dateStarted":"2021-01-22T11:52:19+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=109"],"interpreterSettingId":"spark"}}},{"text":"dfE.filter(dfE(\"SOURCEURL\").like(\"%covid%\")).count","user":"anonymous","dateUpdated":"2021-01-22T11:52:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res98: Long = 14156\n"}]},"apps":[],"jobName":"paragraph_1611309989343_-23532365","id":"20210120-035408_1610821071","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27299","dateFinished":"2021-01-22T11:52:35+0000","dateStarted":"2021-01-22T11:52:35+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=110","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=111"],"interpreterSettingId":"spark"}}},{"text":"dfE.filter(dfE(\"SOURCEURL\").like(\"%COVID%\")).count","user":"anonymous","dateUpdated":"2021-01-22T11:52:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res99: Long = 486\n"}]},"apps":[],"jobName":"paragraph_1611309989343_-783841899","id":"20210120-035428_984854930","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27300","dateFinished":"2021-01-22T11:52:40+0000","dateStarted":"2021-01-22T11:52:40+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=112","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=113"],"interpreterSettingId":"spark"}}},{"text":"dfE.filter(dfE(\"SOURCEURL\").like(\"%covid%\"))\n    .groupBy(\"ActionGeo_CountryCode\")\n    .count()\n    .sort(desc(\"count\"))\n    .withColumnRenamed(\"count\",\"nb_covid_papers\")\n    .show()\n","user":"anonymous","dateUpdated":"2021-01-22T11:53:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+---------------+\n|ActionGeo_CountryCode|nb_covid_papers|\n+---------------------+---------------+\n|                   US|           5126|\n|                   UK|           1376|\n|                   IN|            804|\n|                   CA|            605|\n|                   CH|            474|\n|                 null|            443|\n|                   FR|            443|\n|                   NI|            386|\n|                   IT|            247|\n|                   MX|            245|\n|                   ID|            238|\n|                   AS|            232|\n|                   SF|            201|\n|                   GM|            179|\n|                   BR|            155|\n|                   IS|            151|\n|                   RP|            146|\n|                   RS|            140|\n|                   EI|            131|\n|                   SP|            115|\n+---------------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989343_-1591015549","id":"20210120-114012_274031137","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27302","dateFinished":"2021-01-22T11:53:07+0000","dateStarted":"2021-01-22T11:53:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=114","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=115"],"interpreterSettingId":"spark"}}},{"text":"df_events.filter(df_events(\"SOURCEURL\").like(\"%covid%\"))\n    .groupBy(\"ActionGeo_CountryCode\")\n    .count()\n    .sort(desc(\"count\"))\n    .withColumnRenamed(\"count\",\"nb_covid_papers\")\n    .show()","user":"anonymous","dateUpdated":"2021-01-22T11:53:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+---------------+\n|ActionGeo_CountryCode|nb_covid_papers|\n+---------------------+---------------+\n|                   US|           5126|\n|                   UK|           1376|\n|                   IN|            804|\n|                   CA|            605|\n|                   CH|            474|\n|                 null|            443|\n|                   FR|            443|\n|                   NI|            386|\n|                   IT|            247|\n|                   MX|            245|\n|                   ID|            238|\n|                   AS|            232|\n|                   SF|            201|\n|                   GM|            179|\n|                   BR|            155|\n|                   IS|            151|\n|                   RP|            146|\n|                   RS|            140|\n|                   EI|            131|\n|                   SP|            115|\n+---------------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989343_2033104236","id":"20210120-234249_861075852","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27303","dateFinished":"2021-01-22T11:53:32+0000","dateStarted":"2021-01-22T11:53:26+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=116","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=117"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611319993152_127132515","id":"20210122-125313_571473308","dateCreated":"2021-01-22T12:53:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:37115","text":"%md\n## Réponses aux questions projet Furets","dateUpdated":"2021-01-22T12:53:30+0000","dateFinished":"2021-01-22T12:53:30+0000","dateStarted":"2021-01-22T12:53:30+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Réponses aux questions projet Furets</h2>\n</div>"}]}},{"text":"%md\nRéponse à la question 1 \n\"Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article)\"\"","user":"anonymous","dateUpdated":"2021-01-22T12:53:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Réponse à la question 1<br/>&ldquo;Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article)&rdquo;&quot;</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989344_-1264389679","id":"20210120-114428_474940815","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27304","dateFinished":"2021-01-22T12:53:48+0000","dateStarted":"2021-01-22T12:53:48+0000"},{"text":"\nval question1 = dfE.join(dfM, dfE(\"GLOBALEVENTID\")===dfM(\"GLOBALEVENTID\"))\n        .filter(dfE(\"SOURCEURL\").like(\"%covid%\"))\n        .groupBy(\"SQLDATE\",\"ActionGeo_CountryCode\", \"MentionDocTranslationInfo\")\n        .count()\n        .sort(desc(\"SQLDATE\"),desc(\"count\"))\n        .withColumnRenamed(\"count\",\"nb_covid_papers\")\n        .show()\n","user":"anonymous","dateUpdated":"2021-01-22T12:03:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------------------+-------------------------+---------------+\n| SQLDATE|ActionGeo_CountryCode|MentionDocTranslationInfo|nb_covid_papers|\n+--------+---------------------+-------------------------+---------------+\n|20210102|                   UK|                     null|           7718|\n|20210102|                   US|                     null|           5499|\n|20210102|                   IN|                     null|           1015|\n|20210102|                   FR|                     null|            935|\n|20210102|                 null|                     null|            490|\n|20210102|                   JA|                     null|            458|\n|20210102|                   CA|                     null|            456|\n|20210102|                   NI|                     null|            394|\n|20210102|                   CH|                     null|            317|\n|20210102|                   AS|                     null|            298|\n|20210102|                   US|     srclc:spa;eng:Mos...|            182|\n|20210102|                 null|     srclc:spa;eng:Mos...|            175|\n|20210102|                   FR|     srclc:fra;eng:Mos...|            171|\n|20210102|                   SF|                     null|            163|\n|20210102|                   BR|                     null|            151|\n|20210102|                   IS|                     null|            151|\n|20210102|                 null|     srclc:ita;eng:GT-...|            139|\n|20210102|                   MX|     srclc:spa;eng:Mos...|            138|\n|20210102|                   ID|     srclc:ind;eng:GT-...|            130|\n|20210102|                   IT|     srclc:ita;eng:GT-...|            127|\n+--------+---------------------+-------------------------+---------------+\nonly showing top 20 rows\n\nquestion1: Unit = ()\n"}]},"apps":[],"jobName":"paragraph_1611309989344_-45441965","id":"20210120-154856_1360428942","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27305","dateFinished":"2021-01-22T12:03:04+0000","dateStarted":"2021-01-22T12:03:03+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=134","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=135","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=137","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=138"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317024337_386295432","id":"20210122-120344_1133755634","dateCreated":"2021-01-22T12:03:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35140","text":"%md\nCi dessous la même requête mais avec TRI ASCENDANT sur la date pour vérifier que la requête ci-dessus affiche bien les deux journées!","dateUpdated":"2021-01-22T12:54:59+0000","dateFinished":"2021-01-22T12:54:59+0000","dateStarted":"2021-01-22T12:54:59+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Ci dessous la même requête mais avec TRI ASCENDANT sur la date pour vérifier que la requête ci-dessus affiche bien les deux journées!</p>\n</div>"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317019669_-1074824674","id":"20210122-120339_146867553","dateCreated":"2021-01-22T12:03:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35068","text":"val question1suite = dfE.join(dfM, dfE(\"GLOBALEVENTID\")===dfM(\"GLOBALEVENTID\"))\n        .filter(dfE(\"SOURCEURL\").like(\"%covid%\"))\n        .groupBy(\"SQLDATE\",\"ActionGeo_CountryCode\", \"MentionDocTranslationInfo\")\n        .count()\n        .sort(asc(\"SQLDATE\"),desc(\"count\"))\n        .withColumnRenamed(\"count\",\"nb_covid_papers\")\n        .show()","dateUpdated":"2021-01-22T12:04:13+0000","dateFinished":"2021-01-22T12:04:14+0000","dateStarted":"2021-01-22T12:04:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------------------+-------------------------+---------------+\n| SQLDATE|ActionGeo_CountryCode|MentionDocTranslationInfo|nb_covid_papers|\n+--------+---------------------+-------------------------+---------------+\n|20200102|                   US|                     null|              7|\n|20200102|                   SN|                     null|              5|\n|20200102|                   IN|                     null|              4|\n|20200102|                   GM|                     null|              2|\n|20200102|                   UK|                     null|              2|\n|20200102|                 null|                     null|              1|\n|20200102|                   IZ|                     null|              1|\n|20200102|                 null|     srclc:ita;eng:GT-...|              1|\n|20200102|                   SY|                     null|              1|\n|20200103|                   AY|                     null|             82|\n|20200103|                   US|                     null|             19|\n|20200103|                   IS|                     null|             10|\n|20200103|                   GM|                     null|              9|\n|20200103|                   PO|                     null|              5|\n|20200103|                   CA|                     null|              2|\n|20200103|                   UK|                     null|              2|\n|20200103|                 null|     srclc:ita;eng:GT-...|              1|\n|20200103|                   MX|                     null|              1|\n|20200103|                   GM|     srclc:spa;eng:Mos...|              1|\n|20200103|                   IZ|                     null|              1|\n+--------+---------------------+-------------------------+---------------+\nonly showing top 20 rows\n\nquestion1suite: Unit = ()\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=139","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=140","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=142","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=143"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317248866_-697752359","id":"20210122-120728_1811043770","dateCreated":"2021-01-22T12:07:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35374","text":"%md\nVariante avec SparkSQL","dateUpdated":"2021-01-22T12:07:45+0000","dateFinished":"2021-01-22T12:07:45+0000","dateStarted":"2021-01-22T12:07:45+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Variante avec SparkSQL</p>\n</div>"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317247386_1892391599","id":"20210122-120727_245447443","dateCreated":"2021-01-22T12:07:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35302","text":"//CI DESSOUS NOK java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient;\n\n//dfE.createOrReplaceTempView(\"lesevents\")\n//dfM.createOrReplaceTempView(\"lesmentions\")\n\n//val centenarians = spark.sql(\"SELECT lesevents.SQLDATE, lesevents.ActionGeo_CountryCode, MentionDocTranslationInfo, count(*) as nb_refs_covid FROM lesevents, lesmentions WHERE (lesevents.SOURCEURL like '%COVID%' or lesevents.SOURCEURL like '%COVID%' ) and lesevents.GLOBALEVENTID=lesmentions.GLOBALEVENTID group by lesevents.SQLDATE, lesevents.ActionGeo_CountryCode, MentionDocTranslationInfo ORDER by nb_refs_covid\")\n//centenarians.show()","dateUpdated":"2021-01-22T12:56:48+0000","dateFinished":"2021-01-22T12:56:48+0000","dateStarted":"2021-01-22T12:56:48+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317497355_1875806137","id":"20210122-121137_705433713","dateCreated":"2021-01-22T12:11:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35648","text":"%md\nQuestion2\npour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année","dateUpdated":"2021-01-22T12:12:01+0000","dateFinished":"2021-01-22T12:12:01+0000","dateStarted":"2021-01-22T12:12:01+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Question2<br/>pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année</p>\n</div>"}]}},{"text":"val question2 = dfE\n        .select(\"NumMentions\",\"SQLDATE\",\"ActionGeo_CountryCode\")\n        .filter(dfE(\"ActionGeo_CountryCode\").like(\"%FR%\"))\n        .groupBy(\"SQLDATE\",\"ActionGeo_CountryCode\")\n        .agg(sum(\"NumMentions\"))\n        .withColumnRenamed(\"sum(NumMentions)\",\"NbM\")\n        .sort(desc(\"NbM\"))\n\nquestion2.show()","user":"anonymous","dateUpdated":"2021-01-22T12:12:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317534251_638439885","id":"20210122-121214_666723838","dateCreated":"2021-01-22T12:12:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35738","dateFinished":"2021-01-22T12:12:48+0000","dateStarted":"2021-01-22T12:12:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------------------+-----+\n| SQLDATE|ActionGeo_CountryCode|  NbM|\n+--------+---------------------+-----+\n|20210101|                   FR|14483|\n|20210102|                   FR|14291|\n|20201225|                   FR|   86|\n|20201231|                   FR|   72|\n|20200103|                   FR|   50|\n|20201203|                   FR|   48|\n|20200102|                   FR|   38|\n|20201226|                   FR|   25|\n|20201202|                   FR|   24|\n+--------+---------------------+-----+\n\nquestion2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [SQLDATE: int, ActionGeo_CountryCode: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=164","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=165"],"interpreterSettingId":"spark"}}},{"text":"%md\n\nSolution MongoDB pipelines\n\nWhen using filters with DataFrames or Spark SQL, the underlying Mongo Connector code constructs an aggregation pipeline to filter the data in MongoDB before sending it to Spark.\nhttps://docs.mongodb.com/spark-connector/current/scala/datasets-and-sql","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Solution MongoDB pipelines</p>\n<p>When using filters with DataFrames or Spark SQL, the underlying Mongo Connector code constructs an aggregation pipeline to filter the data in MongoDB before sending it to Spark.<br/><a href=\"https://docs.mongodb.com/spark-connector/current/scala/datasets-and-sql\">https://docs.mongodb.com/spark-connector/current/scala/datasets-and-sql</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989345_195607783","id":"20210120-110958_1871433795","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27309"},{"text":"\ndfE.filter(dfE(\"SOURCEURL\").like(\"%covid%\")).select(dfE(\"GLOBALEVENTID\"),dfE(\"SOURCEURL\")).show(5, truncate=400)\n\n","user":"anonymous","dateUpdated":"2021-01-22T12:22:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|GLOBALEVENTID|                                                                                                                                                                                    SOURCEURL|\n+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|    962299553|                                                                            http://www.digitaljournal.com/news/world/covid-woes-not-new-checks-weigh-on-post-brexit-passengers/article/583296|\n|    962337101|                                                                                                           https://www.brownsvilleherald.com/2020/12/31/utrgv-exhausts-900-covid-19-vaccines/|\n|    962299681|https://www.msn.com/en-ca/news/canada/covid-19-update-premier-jason-kenney-set-to-speak-at-11-am-ucp-minister-tracy-allard-vacationed-in-hawaii-amid-covid-19-second-wave-reports/ar-BB1cp4Up|\n|    962337112|                                                             https://www.independent.ie/world-news/europe/britain/madeleines-parents-say-covid-has-hit-search-but-hope-lives-on-39922934.html|\n|    962299735|                                   https://www.fauquier.com/news/update-new-covid-19-cases-in-the-state-top-5-000-for-second-day-positivity/article_9ac6a42e-e090-11ea-ae5c-fbba5f1b640e.html|\n+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989345_-583563989","id":"20210120-032557_1648760433","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27310","dateFinished":"2021-01-22T12:22:01+0000","dateStarted":"2021-01-22T12:22:00+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=171"],"interpreterSettingId":"spark"}}},{"text":"%md\nProblème 1 : SparkSQL donne le message suivant :","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Problème 1 : SparkSQL donne le message suivant :</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989345_-381586936","id":"20210120-112616_1717666907","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27311"},{"text":"\n//CI DESSOUS NOK java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient;\n\ndfE.createOrReplaceTempView(\"joinQ1\")\nval centenarians = spark.sql(\"SELECT GLOBALEVENTID, SOURCEURL FROM lesevents WHERE (SOURCEURL like '%COVID%' or SOURCEURL like '%COVID%' )\"\n\n)\ncentenarians.show()","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611309989345_-217655096","id":"20210120-224651_2044712411","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27313"},{"text":"%md\nDepending on the dataset, filtering data using MongoDB's aggregation framework may perform more efficiently than the direct use of RDD filters and dataset filters.\nhttps://docs.mongodb.com/spark-connector/current/scala/aggregation","user":"anonymous","dateUpdated":"2021-01-22T12:16:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Depending on the dataset, filtering data using MongoDB&rsquo;s aggregation framework may perform more efficiently than the direct use of RDD filters and dataset filters.<br/><a href=\"https://docs.mongodb.com/spark-connector/current/scala/aggregation\">https://docs.mongodb.com/spark-connector/current/scala/aggregation</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989346_934232690","id":"20210120-105150_135786233","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27315","dateFinished":"2021-01-22T12:16:27+0000","dateStarted":"2021-01-22T12:16:27+0000"},{"text":"%md\nAggregation\n\nPass an aggregation pipeline to a MongoRDD instance to filter data and perform aggregations in MongoDB before passing documents to Spark.\nAggregation pipelines handle null results whereas the filter methods do not. If the filter does not match any documents, the operation throws the following exception:\nERROR Executor: Exception in task 0.0 in stage 1.0 (TID 8) java.lang.NullPointerException\n\n","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Aggregation</p>\n<p>Pass an aggregation pipeline to a MongoRDD instance to filter data and perform aggregations in MongoDB before passing documents to Spark.<br/>Aggregation pipelines handle null results whereas the filter methods do not. If the filter does not match any documents, the operation throws the following exception:<br/>ERROR Executor: Exception in task 0.0 in stage 1.0 (TID 8) java.lang.NullPointerException</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989346_-433370787","id":"20210120-105400_1243853640","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27316"},{"text":"%md\nExemple de pipeline (sans regex)","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Exemple de pipeline (sans regex)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989346_-902939132","id":"20210120-174855_904900108","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27317"},{"text":"val rdd = MongoSpark.load(sc, readConfigEvents)  // rdd est un MongoRDD, classe pour pipelines\nval mongoRddEvents = rdd.withPipeline(Seq(Document.parse(\"{ $match: { GoldsteinScale  : { $gt : 3 } } }\")))\nprintln(mongoRddEvents.count)\n","user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"30819\nrdd: com.mongodb.spark.rdd.MongoRDD[org.bson.Document] = MongoRDD[144] at RDD at MongoRDD.scala:51\nmongoRddEvents: com.mongodb.spark.rdd.MongoRDD[org.bson.Document] = MongoRDD[145] at RDD at MongoRDD.scala:51\n"}]},"apps":[],"jobName":"paragraph_1611309989346_405531559","id":"20210120-032140_786867505","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27318"},{"text":"%md\nLe code ci-dessous est correct : pipeline avec regex.\n","user":"anonymous","dateUpdated":"2021-01-22T12:19:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Le code ci-dessous est correct : pipeline avec regex.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611309989346_589092019","id":"20210120-111915_195877314","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27319","dateFinished":"2021-01-22T12:19:30+0000","dateStarted":"2021-01-22T12:19:30+0000"},{"text":"val rdd2 = MongoSpark.load(sc, readConfigEvents)  // rdd est un MongoRDD, classe pour pipelines\nval mongoRddEvents2 = rdd.withPipeline(Seq(Document.parse(\"{ $regexMatch: { input: '$SOURCEURL', regex: /covid/i } }\")))\nprintln(aggregatedRdd2.count)\n ","user":"anonymous","dateUpdated":"2021-01-22T12:20:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611317975640_1340602864","id":"20210122-121935_283870807","dateCreated":"2021-01-22T12:19:35+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35995","dateFinished":"2021-01-22T12:20:13+0000","dateStarted":"2021-01-22T12:20:13+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:140: error: object withPipeline is not a member of package com.mongodb.spark.rdd\n       val mongoRddEvents2 = rdd.withPipeline(Seq(Document.parse(\"{ $regexMatch: { input: '$SOURCEURL', regex: /covid/i } }\")))\n                                 ^\n<console>:143: error: not found: value aggregatedRdd2\n       println(aggregatedRdd2.count)\n               ^\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611318021572_-373636756","id":"20210122-122021_1314170649","dateCreated":"2021-01-22T12:20:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:36145","text":"%md\nMais malheureusement dans la version de base de Atlas les regex ne sont pas autorisés !\nCommand failed with error 8000 (AtlasError): '$regexMatch is not allowed in this atlas tier' on server cluster0-shard-00-00.ldu6v.mongodb.net:27017.","dateUpdated":"2021-01-22T12:20:28+0000","dateFinished":"2021-01-22T12:20:28+0000","dateStarted":"2021-01-22T12:20:28+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Mais malheureusement dans la version de base de Atlas les regex ne sont pas autorisés !<br/>Command failed with error 8000 (AtlasError): &lsquo;$regexMatch is not allowed in this atlas tier&rsquo; on server cluster0-shard-00-00.ldu6v.mongodb.net:27017.</p>\n</div>"}]}},{"text":"%md\nQuestion 3\npour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.","user":"anonymous","dateUpdated":"2021-01-22T12:22:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611318138944_1369717523","id":"20210122-122218_1920596990","dateCreated":"2021-01-22T12:22:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:36310","dateFinished":"2021-01-22T12:22:34+0000","dateStarted":"2021-01-22T12:22:34+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Question 3<br/>pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.</p>\n</div>"}]}},{"text":"val gkg_light2 = df_gkg.select(\"GKGRECORDID\",\"DATE\",\"SourceCommonName\",\"Themes\",\"V2Themes\",\"Locations\",\"V2Persons\",\"Persons\",\"V2Tone\")\ngkg_light2.show()","user":"anonymous","dateUpdated":"2021-01-22T13:25:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|       GKGRECORDID|          DATE|SourceCommonName|              Themes|            V2Themes|           Locations|           V2Persons|             Persons|              V2Tone|\n+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n| 20210102111500-T0|20210102111500|finexpert.e15.cz|ECON_WORLDCURRENC...|TAX_ETHNICITY_CZE...|1#Czech Republic#...|                null|                null|-0.64102564102564...|\n| 20210102111500-T1|20210102111500|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|GEN_HOLIDAY,821;T...|                null|                null|                null|-2.22222222222222...|\n| 20210102111500-T2|20210102111500| nedd.tiscali.cz|TAX_ETHNICITY;TAX...|GENERAL_HEALTH,19...|1#Czech Republic#...|Vladimir Ilyich L...|vladimir ilyich l...|1.1142061281337,3...|\n| 20210102111500-T3|20210102111500|finexpert.e15.cz|GENERAL_HEALTH;ME...|GENERAL_GOVERNMEN...|                null|                null|                null|1.16959064327485,...|\n| 20210102111500-T4|20210102111500|finexpert.e15.cz|GENERAL_HEALTH;ME...|GENERAL_GOVERNMEN...|                null|                null|                null|1.13636363636364,...|\n| 20210102111500-T5|20210102111500|finexpert.e15.cz|CRISISLEX_T11_UPD...|CRISISLEX_T11_UPD...|                null|                null|                null|0,1.4925373134328...|\n| 20210102111500-T6|20210102111500| sputniknews.com|TAX_WORLDLANGUAGE...|AGRICULTURE,2065;...|1#China#CH#CH#35#...|Andrei Denisov,12...|andrei denisov;vl...|1.28,3.2,1.92,5.1...|\n| 20210102111500-T7|20210102111500| sputniknews.com|GENERAL_HEALTH;HE...|WB_1305_HEALTH_SE...|4#Paris, France (...|Stefano Rellandin...|  stefano rellandini|-1.82926829268293...|\n| 20210102111500-T8|20210102111500|  ceskenoviny.cz|KILL;CRISISLEX_CR...|AFFECT,286;AFFECT...|1#Montenegro#MJ#M...|                null|                null|-6.6079295154185,...|\n| 20210102111500-T9|20210102111500| sputniknews.com|UNGP_FORESTS_RIVE...|TAX_ETHNICITY_CZE...|1#Czech Republic#...|                null|                null|-0.92024539877300...|\n|20210102111500-T10|20210102111500|  ceskenoviny.cz|WB_1921_PRIVATE_S...|KILL,196;KILL,130...|4#Libreville, Est...|                null|                null|-3.83386581469649...|\n|20210102111500-T11|20210102111500|        senat.cz|USPEC_POLITICS_GE...|GENERAL_HEALTH,11...|4#Vladislav, Vyso...|                null|                null|0.934579439252336...|\n|20210102111500-T12|20210102111500| sputniknews.com|TAX_FNCACT;TAX_FN...|WB_2433_CONFLICT_...|1#China#CH#CH#35#...|Iliy Pitalev Wang...|iliy pitalev wang...|-1.74672489082969...|\n|20210102111500-T13|20210102111500| sputniknews.com|TAX_FNCACT;TAX_FN...|GENERAL_HEALTH,12...|1#Saint Lucia#ST#...|Nicolet Nicolet,1775|     nicolet nicolet|5.73394495412844,...|\n|20210102111500-T14|20210102111500|        senat.cz|USPEC_POLITICS_GE...|LEGISLATION,253;L...|                null|                null|                null|-2.61437908496732...|\n|20210102111500-T15|20210102111500| sputniknews.com|TAX_WORLDMAMMALS;...|TAX_DISEASE_EPIDE...|4#Paris, France (...|                null|                null|-1.73267326732673...|\n|20210102111500-T16|20210102111500|finexpert.e15.cz|ECON_WORLDCURRENC...|TAX_ETHNICITY_CZE...|1#Czech Republic#...|                null|                null|-0.64516129032258...|\n|20210102111500-T17|20210102111500|        senat.cz|USPEC_POLITICS_GE...|EPU_CATS_HEALTHCA...|                null|                null|                null|0.934579439252336...|\n|20210102111500-T18|20210102111500|        senat.cz|USPEC_POLITICS_GE...|LEGISLATION,250;L...|                null|                null|                null|-2.84090909090909...|\n|20210102111500-T19|20210102111500|        senat.cz|TAX_FNCACT;TAX_FN...|GENERAL_HEALTH,31...|4#Milan, Lombardi...|                null|                null|2.23880597014925,...|\n+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\ngkg_light2: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, DATE: decimal(38,0) ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611309989348_-814409048","id":"20210122-021459_173568803","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27327","dateFinished":"2021-01-22T13:25:52+0000","dateStarted":"2021-01-22T13:25:51+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=186"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611318169926_2119773490","id":"20210122-122249_1203025006","dateCreated":"2021-01-22T12:22:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:36400","text":"dfG.show()","dateUpdated":"2021-01-22T12:23:02+0000","dateFinished":"2021-01-22T12:23:04+0000","dateStarted":"2021-01-22T12:23:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+------------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\n|          DATE|       GKGRECORDID|           Locations|             Persons|SourceCommonName|              Themes|              V2Tone|                 _id|\n+--------------+------------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\n|20210102154500| 20210102154500-T0|1#Czech Republic#...|                null|        blesk.cz|ECON_BITCOIN;USPE...|-1.61943319838057...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T1|2#California, Uni...|spotify netflix;m...|        blesk.cz|TAX_FNCACT;TAX_FN...|0.352112676056338...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T2|                null|                null|finexpert.e15.cz|GENERAL_HEALTH;ME...|1.15606936416185,...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T3|1#Czech Republic#...|                null| sputniknews.com|TAX_FNCACT;TAX_FN...|-5.06208213944604...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T4|2#California, Uni...|                null| sputniknews.com|GENERAL_GOVERNMEN...|-2.13523131672598...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T5|                null|                null|finexpert.e15.cz|GENERAL_HEALTH;ME...|1.16959064327485,...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T6|                null|                null| sputniknews.com|DISASTER_FIRE;CRI...|-2.36051502145923...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T7|1#Czech Republic#...|milo zeman;mirosl...|      tn.nova.cz|TAX_ETHNICITY;TAX...|-1.43884892086331...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T8|1#China#CH#CH#35#...|                null|      tn.nova.cz|TAX_ETHNICITY;TAX...|4.12371134020619,...|[600ab90b23411d13...|\n|20210102154500| 20210102154500-T9|                null|         david malik|        blesk.cz|NATURAL_DISASTER;...|-2.22222222222222...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T10|                null|                null|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|-4.79041916167665...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T11|1#Slovak Republic...|                null| sputniknews.com|LEADER;TAX_FNCACT...|-2.02839756592292...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T12|1#Czech Republic#...|    petr david josek| sputniknews.com|HEALTH_VACCINATIO...|1.40845070422535,...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T13|                null|                null|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|0,2.6315789473684...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T14|1#France#FR#FR#46...|alpes-maritimes a...| francetvinfo.fr|USPEC_POLITICS_GE...|-1.71428571428571...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T15|1#Germany#GM#GM#5...|                null|lamanchelibre.fr|ECON_BITCOIN;TAX_...|-0.55865921787709...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T16|4#Coutances, Bass...|                null|lamanchelibre.fr|TAX_FNCACT;TAX_FN...|-5,1.25,6.25,7.5,...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T17|1#China#CH#CH#35#...|mitch mcconnell;d...|     lesechos.fr|USPEC_POLICY1;EPU...|-3.95604395604396...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T18|                null|  alain lechevallier|lamanchelibre.fr|LEADER;TAX_FNCACT...|0,0,0,0,18.681318...|[600ab90b23411d13...|\n|20210102154500|20210102154500-T19|1#Germany#GM#GM#5...|narendra modi;joe...|    latribune.fr|TAX_ETHNICITY;TAX...|1.440329218107,3....|[600ab90b23411d13...|\n+--------------+------------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=172"],"interpreterSettingId":"spark"}}},{"text":"val gkg_light = dfG.select(\"GKGRECORDID\",\"DATE\",\"SourceCommonName\",\"Themes\",\"Locations\",\"Persons\",\"V2Tone\")\n\ngkg_light.show()","user":"anonymous","dateUpdated":"2021-01-22T12:24:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+\n|       GKGRECORDID|          DATE|SourceCommonName|              Themes|           Locations|             Persons|              V2Tone|\n+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+\n| 20210102154500-T0|20210102154500|        blesk.cz|ECON_BITCOIN;USPE...|1#Czech Republic#...|                null|-1.61943319838057...|\n| 20210102154500-T1|20210102154500|        blesk.cz|TAX_FNCACT;TAX_FN...|2#California, Uni...|spotify netflix;m...|0.352112676056338...|\n| 20210102154500-T2|20210102154500|finexpert.e15.cz|GENERAL_HEALTH;ME...|                null|                null|1.15606936416185,...|\n| 20210102154500-T3|20210102154500| sputniknews.com|TAX_FNCACT;TAX_FN...|1#Czech Republic#...|                null|-5.06208213944604...|\n| 20210102154500-T4|20210102154500| sputniknews.com|GENERAL_GOVERNMEN...|2#California, Uni...|                null|-2.13523131672598...|\n| 20210102154500-T5|20210102154500|finexpert.e15.cz|GENERAL_HEALTH;ME...|                null|                null|1.16959064327485,...|\n| 20210102154500-T6|20210102154500| sputniknews.com|DISASTER_FIRE;CRI...|                null|                null|-2.36051502145923...|\n| 20210102154500-T7|20210102154500|      tn.nova.cz|TAX_ETHNICITY;TAX...|1#Czech Republic#...|milo zeman;mirosl...|-1.43884892086331...|\n| 20210102154500-T8|20210102154500|      tn.nova.cz|TAX_ETHNICITY;TAX...|1#China#CH#CH#35#...|                null|4.12371134020619,...|\n| 20210102154500-T9|20210102154500|        blesk.cz|NATURAL_DISASTER;...|                null|         david malik|-2.22222222222222...|\n|20210102154500-T10|20210102154500|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|                null|                null|-4.79041916167665...|\n|20210102154500-T11|20210102154500| sputniknews.com|LEADER;TAX_FNCACT...|1#Slovak Republic...|                null|-2.02839756592292...|\n|20210102154500-T12|20210102154500| sputniknews.com|HEALTH_VACCINATIO...|1#Czech Republic#...|    petr david josek|1.40845070422535,...|\n|20210102154500-T13|20210102154500|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|                null|                null|0,2.6315789473684...|\n|20210102154500-T14|20210102154500| francetvinfo.fr|USPEC_POLITICS_GE...|1#France#FR#FR#46...|alpes-maritimes a...|-1.71428571428571...|\n|20210102154500-T15|20210102154500|lamanchelibre.fr|ECON_BITCOIN;TAX_...|1#Germany#GM#GM#5...|                null|-0.55865921787709...|\n|20210102154500-T16|20210102154500|lamanchelibre.fr|TAX_FNCACT;TAX_FN...|4#Coutances, Bass...|                null|-5,1.25,6.25,7.5,...|\n|20210102154500-T17|20210102154500|     lesechos.fr|USPEC_POLICY1;EPU...|1#China#CH#CH#35#...|mitch mcconnell;d...|-3.95604395604396...|\n|20210102154500-T18|20210102154500|lamanchelibre.fr|LEADER;TAX_FNCACT...|                null|  alain lechevallier|0,0,0,0,18.681318...|\n|20210102154500-T19|20210102154500|    latribune.fr|TAX_ETHNICITY;TAX...|1#Germany#GM#GM#5...|narendra modi;joe...|1.440329218107,3....|\n+------------------+--------------+----------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\ngkg_light: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, DATE: decimal(14,0) ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611309989348_829274997","id":"20210122-010246_889664895","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27328","dateFinished":"2021-01-22T12:24:41+0000","dateStarted":"2021-01-22T12:24:41+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=173"],"interpreterSettingId":"spark"}}},{"text":"val gkg_2 = gkg_light.withColumn(\"avg_tone\",substring_index($\"V2Tone\",\",\",1))\n                         .filter(!($\"SourceCommonName\" === \"\"))\n                         .withColumn(\"date\",substring($\"DATE\",0,8).cast(\"Int\"))\n                         .withColumn(\"persons_arr\",split(gkg_light(\"Persons\"),\";\"))\n                         .withColumn(\"locations_arr\",split(gkg_light(\"Locations\"),\";\"))\n                         .withColumn(\"themes_arr\",split(gkg_light(\"themes\"),\";\"))\ngkg_2.show()","user":"anonymous","dateUpdated":"2021-01-22T13:26:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------+----------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+\n|       GKGRECORDID|    date|SourceCommonName|              Themes|           Locations|             Persons|              V2Tone|          avg_tone|         persons_arr|       locations_arr|          themes_arr|\n+------------------+--------+----------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+\n| 20210102154500-T0|20210102|        blesk.cz|ECON_BITCOIN;USPE...|1#Czech Republic#...|                null|-1.61943319838057...| -1.61943319838057|                null|[1#Czech Republic...|[ECON_BITCOIN, US...|\n| 20210102154500-T1|20210102|        blesk.cz|TAX_FNCACT;TAX_FN...|2#California, Uni...|spotify netflix;m...|0.352112676056338...| 0.352112676056338|[spotify netflix,...|[2#California, Un...|[TAX_FNCACT, TAX_...|\n| 20210102154500-T2|20210102|finexpert.e15.cz|GENERAL_HEALTH;ME...|                null|                null|1.15606936416185,...|  1.15606936416185|                null|                null|[GENERAL_HEALTH, ...|\n| 20210102154500-T3|20210102| sputniknews.com|TAX_FNCACT;TAX_FN...|1#Czech Republic#...|                null|-5.06208213944604...| -5.06208213944604|                null|[1#Czech Republic...|[TAX_FNCACT, TAX_...|\n| 20210102154500-T4|20210102| sputniknews.com|GENERAL_GOVERNMEN...|2#California, Uni...|                null|-2.13523131672598...| -2.13523131672598|                null|[2#California, Un...|[GENERAL_GOVERNME...|\n| 20210102154500-T5|20210102|finexpert.e15.cz|GENERAL_HEALTH;ME...|                null|                null|1.16959064327485,...|  1.16959064327485|                null|                null|[GENERAL_HEALTH, ...|\n| 20210102154500-T6|20210102| sputniknews.com|DISASTER_FIRE;CRI...|                null|                null|-2.36051502145923...| -2.36051502145923|                null|                null|[DISASTER_FIRE, C...|\n| 20210102154500-T7|20210102|      tn.nova.cz|TAX_ETHNICITY;TAX...|1#Czech Republic#...|milo zeman;mirosl...|-1.43884892086331...| -1.43884892086331|[milo zeman, miro...|[1#Czech Republic...|[TAX_ETHNICITY, T...|\n| 20210102154500-T8|20210102|      tn.nova.cz|TAX_ETHNICITY;TAX...|1#China#CH#CH#35#...|                null|4.12371134020619,...|  4.12371134020619|                null|[1#China#CH#CH#35...|[TAX_ETHNICITY, T...|\n| 20210102154500-T9|20210102|        blesk.cz|NATURAL_DISASTER;...|                null|         david malik|-2.22222222222222...| -2.22222222222222|       [david malik]|                null|[NATURAL_DISASTER...|\n|20210102154500-T10|20210102|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|                null|                null|-4.79041916167665...| -4.79041916167665|                null|                null|[TAX_FNCACT, TAX_...|\n|20210102154500-T11|20210102| sputniknews.com|LEADER;TAX_FNCACT...|1#Slovak Republic...|                null|-2.02839756592292...| -2.02839756592292|                null|[1#Slovak Republi...|[LEADER, TAX_FNCA...|\n|20210102154500-T12|20210102| sputniknews.com|HEALTH_VACCINATIO...|1#Czech Republic#...|    petr david josek|1.40845070422535,...|  1.40845070422535|  [petr david josek]|[1#Czech Republic...|[HEALTH_VACCINATI...|\n|20210102154500-T13|20210102|finexpert.e15.cz|TAX_FNCACT;TAX_FN...|                null|                null|0,2.6315789473684...|                 0|                null|                null|[TAX_FNCACT, TAX_...|\n|20210102154500-T14|20210102| francetvinfo.fr|USPEC_POLITICS_GE...|1#France#FR#FR#46...|alpes-maritimes a...|-1.71428571428571...| -1.71428571428571|[alpes-maritimes ...|[1#France#FR#FR#4...|[USPEC_POLITICS_G...|\n|20210102154500-T15|20210102|lamanchelibre.fr|ECON_BITCOIN;TAX_...|1#Germany#GM#GM#5...|                null|-0.55865921787709...|-0.558659217877095|                null|[1#Germany#GM#GM#...|[ECON_BITCOIN, TA...|\n|20210102154500-T16|20210102|lamanchelibre.fr|TAX_FNCACT;TAX_FN...|4#Coutances, Bass...|                null|-5,1.25,6.25,7.5,...|                -5|                null|[4#Coutances, Bas...|[TAX_FNCACT, TAX_...|\n|20210102154500-T17|20210102|     lesechos.fr|USPEC_POLICY1;EPU...|1#China#CH#CH#35#...|mitch mcconnell;d...|-3.95604395604396...| -3.95604395604396|[mitch mcconnell,...|[1#China#CH#CH#35...|[USPEC_POLICY1, E...|\n|20210102154500-T18|20210102|lamanchelibre.fr|LEADER;TAX_FNCACT...|                null|  alain lechevallier|0,0,0,0,18.681318...|                 0|[alain lechevallier]|                null|[LEADER, TAX_FNCA...|\n|20210102154500-T19|20210102|    latribune.fr|TAX_ETHNICITY;TAX...|1#Germany#GM#GM#5...|narendra modi;joe...|1.440329218107,3....|    1.440329218107|[narendra modi, j...|[1#Germany#GM#GM#...|[TAX_ETHNICITY, T...|\n+------------------+--------+----------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\ngkg_2: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, date: int ... 9 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611309989348_-2147020644","id":"20210122-010821_109193509","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27329","dateFinished":"2021-01-22T13:26:51+0000","dateStarted":"2021-01-22T13:26:50+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=187"],"interpreterSettingId":"spark"}}},{"text":"val gkg2_persons = gkg_2.select($\"date\",$\"GKGRECORDID\",$\"SourceCommonName\",$\"avg_tone\",explode_outer($\"persons_arr\").as(\"persons_2\"))\nval gkg2_locations = gkg_2.select($\"date\",$\"GKGRECORDID\",$\"SourceCommonName\",$\"avg_tone\",explode_outer($\"locations_arr\").as(\"locations_2\"))\nval gkg2_themes = gkg_2.select($\"date\",$\"GKGRECORDID\",$\"SourceCommonName\",$\"avg_tone\",explode_outer($\"themes_arr\").as(\"themes_2\"))\n\n\nval requete3_persons = gkg2_persons\n    .groupBy(\"date\",\"SourceCommonName\",\"persons_2\")\n    .agg(count($\"GKGRECORDID\").cast(\"int\").as(\"nombre_articles\"),avg($\"avg_tone\").as(\"ton_moyen\"))\nval requete3_locations = gkg2_locations\n        .groupBy(\"date\",\"SourceCommonName\",\"locations_2\")\n        .agg(count($\"GKGRECORDID\").cast(\"int\").as(\"nombre_articles\"),avg($\"avg_tone\").as(\"ton_moyen\"))\nval requete3_themes = gkg2_themes\n    .groupBy(\"date\",\"SourceCommonName\",\"themes_2\")\n    .agg(count($\"GKGRECORDID\").cast(\"int\").as(\"nombre_articles\"),avg($\"avg_tone\").as(\"ton_moyen\"))","user":"anonymous","dateUpdated":"2021-01-22T12:25:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg2_persons: org.apache.spark.sql.DataFrame = [date: int, GKGRECORDID: string ... 3 more fields]\ngkg2_locations: org.apache.spark.sql.DataFrame = [date: int, GKGRECORDID: string ... 3 more fields]\ngkg2_themes: org.apache.spark.sql.DataFrame = [date: int, GKGRECORDID: string ... 3 more fields]\nrequete3_persons: org.apache.spark.sql.DataFrame = [date: int, SourceCommonName: string ... 3 more fields]\nrequete3_locations: org.apache.spark.sql.DataFrame = [date: int, SourceCommonName: string ... 3 more fields]\nrequete3_themes: org.apache.spark.sql.DataFrame = [date: int, SourceCommonName: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611309989349_-696598476","id":"20210122-015949_2044038575","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27330","dateFinished":"2021-01-22T12:25:11+0000","dateStarted":"2021-01-22T12:25:10+0000"},{"text":"\n    \nrequete3_persons.show()","user":"anonymous","dateUpdated":"2021-01-22T12:25:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------------+--------------------+---------------+--------------------+\n|    date|   SourceCommonName|           persons_2|nombre_articles|           ton_moyen|\n+--------+-------------------+--------------------+---------------+--------------------+\n|20210102|         tn.nova.cz|   miroslav kalousek|              1|   -1.43884892086331|\n|20210102|       numerama.com|       swan laurence|              1|    3.39403973509934|\n|20210102|       numerama.com|raphael bob-waksberg|              1|    3.39403973509934|\n|20210102|     kababachir.com|       donald gracie|              1|    -2.7027027027027|\n|20210102|     kababachir.com|       michael flynn|              1|    -2.7027027027027|\n|20210102|     kababachir.com|         betsy devos|              1|    -2.7027027027027|\n|20210102|       latribune.fr|        zydus cadila|              1|    2.18181818181818|\n|20210102|      frandroid.com|         abdel hamid|              1|    1.12627986348123|\n|20210102|        telecran.lu|        karine ferri|              1|    2.66666666666667|\n|20210102|   lamanchelibre.fr|      belfort vosges|              1|    -3.9039039039039|\n|20210102|     nna-leb.gov.lb|  abdel hamid karami|              1|  -0.833333333333333|\n|20210102|    francetvinfo.fr|       pep guardiola|              3| -0.5050505050505066|\n|20210102|           delfi.ee|       rakvere tanel|              1|   -5.98591549295775|\n|20210102| tartu.postimees.ee| kristiina reidolvil|              1|     2.9585798816568|\n|20210102|      die-glocke.de|          jens spahn|              1|   -1.42045454545455|\n|20210102|      die-glocke.de|       vfl wolfsburg|              2|0.023915435021764964|\n|20210102|rundschau-online.de|inzidenzzahl inzi...|              1|   -2.74744943619116|\n|20210102|rundschau-online.de|      mikhail kokott|              1|   -2.74744943619116|\n|20210102|           krzbb.de|hoffenheim sebast...|              1|   -1.86915887850467|\n|20210102|rundschau-online.de|          bonn katja|              2|   -1.61525628750584|\n+--------+-------------------+--------------------+---------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989349_-35619146","id":"20210122-020719_397787761","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27331","dateFinished":"2021-01-22T12:25:26+0000","dateStarted":"2021-01-22T12:25:18+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=175","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=176"],"interpreterSettingId":"spark"}}},{"text":"\nrequete3_locations.show()","user":"anonymous","dateUpdated":"2021-01-22T12:25:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------------+--------------------+---------------+-------------------+\n|    date| SourceCommonName|         locations_2|nombre_articles|          ton_moyen|\n+--------+-----------------+--------------------+---------------+-------------------+\n|20210102| standartnews.com|1#Germany#GM#GM#5...|              8|-0.9411765062789043|\n|20210102|       varna24.bg|1#Germany#GM#GM#5...|              3|-1.7155601303825667|\n|20210102|       varna24.bg|4#Cambridge, Camb...|              2|  -2.57334019557385|\n|20210102|       varna24.bg|1#Romania#RO#RO#4...|              2|  -2.57334019557385|\n|20210102|     elbalad.news|4#Nadi Az Zamalik...|             23|-1.6076246212504095|\n|20210102|     elbalad.news|4#Red Sea, Djibou...|              7| -2.459916464555947|\n|20210102|     elbalad.news|5#Qalubia, Al Qal...|              3|-1.0348841744760302|\n|20210102|      iraqicp.com|1#Iraq#IZ#IZ#33#4...|             27|-2.2128016496381413|\n|20210102| alwatanvoice.com|4#Mecca, Makkah, ...|              2|-1.8387314439945999|\n|20210102|      alnilin.com|4#Geneva, Genè, S...|              2|   1.57342657342657|\n|20210102|     khaberni.com|1#Australia#AS#AS...|              3| -2.901912438754543|\n|20210102|    alyaoum24.com|3#Washington, Was...|              2|  -6.66666666666667|\n|20210102|    alyaoum24.com|1#Iraq#IZ#IZ#33#4...|              2|  -6.66666666666667|\n|20210102|     alriyadh.com|4#Amsterdam, Noor...|              1|  -11.1413043478261|\n|20210102|     alriyadh.com|1#France#FR#FR#46...|              3| -5.465706100438157|\n|20210102|     alquds.co.uk|1#India#IN#IN#20#...|              2|  -6.26791857798165|\n|20210102|      iraqicp.com|5#Diyala, DiyaláZ...|              1|  -4.49438202247191|\n|20210102|  akhbarelyom.com|1#Turkey#TU#TU#39...|              7| -5.086397351690431|\n|20210102|skynewsarabia.com|4#Marwan, ?Alab, ...|              1|   4.22535211267606|\n|20210102| alwatanvoice.com|4#Al Madinah, Al ...|              1|                0.0|\n+--------+-----------------+--------------------+---------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989349_1542120763","id":"20210122-020718_1990636401","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27332","dateFinished":"2021-01-22T12:25:39+0000","dateStarted":"2021-01-22T12:25:38+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=177","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=178"],"interpreterSettingId":"spark"}}},{"text":"\nrequete3_themes.show()","user":"anonymous","dateUpdated":"2021-01-22T12:25:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------------+--------------------+---------------+--------------------+\n|    date| SourceCommonName|            themes_2|nombre_articles|           ton_moyen|\n+--------+-----------------+--------------------+---------------+--------------------+\n|20210102|       varna24.bg|WB_694_BROADCAST_...|             46|  1.8595692147500238|\n|20210102| standartnews.com|   TAX_FNCACT_VICTIM|              3| -3.5710424732769646|\n|20210102| standartnews.com|   WB_2167_PANDEMICS|              7| -0.5703016959996842|\n|20210102| standartnews.com|TAX_MILITARY_TITL...|              1|                -2.0|\n|20210102| standartnews.com|        WB_167_PORTS|              2|  -1.461149139987201|\n|20210102| standartnews.com|EPU_POLICY_REGULA...|              2|0.028258412311972986|\n|20210102| standartnews.com| EPU_CATS_REGULATION|              2|0.028258412311972986|\n|20210102| standartnews.com|TAX_FNCACT_AUTHOR...|              8| -1.2087759263289632|\n|20210102|       varna24.bg|TAX_WORLDLANGUAGE...|              2|   -2.57334019557385|\n|20210102|       varna24.bg|EPU_ECONOMY_HISTORIC|              2|   -2.57334019557385|\n|20210102|       varna24.bg|    WB_1406_DISEASES|              4|   -3.15342383904257|\n|20210102|       varna24.bg|              LEADER|              2|    2.24719101123596|\n|20210102|almadenahnews.com|WB_1674_HEALTH_AN...|              1|    4.13943355119826|\n|20210102|almadenahnews.com|  TAX_FNCACT_TEACHER|              1|    4.13943355119826|\n|20210102|almadenahnews.com|     TAX_FNCACT_POET|              2|   3.515183267057735|\n|20210102|almadenahnews.com|WB_2433_CONFLICT_...|              6| -0.4409501692414852|\n|20210102|   sarayanews.com|     UNGP_HEALTHCARE|             32|  -4.640991228088167|\n|20210102|   sarayanews.com| TAX_FNCACT_MINISTER|             17|  -2.132424867791382|\n|20210102|     elbalad.news|           EDUCATION|            267|-0.30607441155368786|\n|20210102|     elbalad.news|USPEC_POLITICS_GE...|            193| -1.4012201466554528|\n+--------+-----------------+--------------------+---------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611309989349_-163962557","id":"20210122-020715_1441810218","dateCreated":"2021-01-22T10:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27333","dateFinished":"2021-01-22T12:25:56+0000","dateStarted":"2021-01-22T12:25:49+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=179","http://ip-172-31-23-56.ec2.internal:4040/jobs/job?id=180"],"interpreterSettingId":"spark"}}},{"user":"anonymous","dateUpdated":"2021-01-22T10:06:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611309989349_1811736237","id":"20210122-020456_1823970426","dateCreated":"2021-01-22T10:06:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27334"}],"name":"projet_final_exploration","id":"2FXV74DJS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
